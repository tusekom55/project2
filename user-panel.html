<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trading Dashboard - GlobalTradePro</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
            <!-- Chart.js CDN - Latest Version -->
        <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.min.js" defer></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #ffffff;
            overflow-x: hidden;
            margin: 0;
            padding: 0;
        }
        
        .dashboard-container {
            display: flex;
            min-height: 100vh;
        }
        
        /* Sol Navigasyon Paneli */
        .sidebar {
            width: 280px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            padding: 24px 0;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            transition: all 0.3s ease;
        }
        
        .sidebar-header {
            padding: 0 20px 30px;
            border-bottom: 1px solid #2a2f3e;
            margin-bottom: 20px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 16px;
            font-size: 28px;
            font-weight: 800;
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 32px;
        }
        
        .nav-menu {
            padding: 0 10px;
        }
        
        .nav-item {
            margin-bottom: 5px;
        }
        
        .nav-link {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px 20px;
            color: #94a3b8;
            text-decoration: none;
            border-radius: 12px;
            transition: all 0.3s ease;
            font-weight: 600;
            margin: 4px 16px;
            position: relative;
            overflow: hidden;
        }
        
        .nav-link::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 0;
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            transition: width 0.3s ease;
            z-index: -1;
        }
        
        .nav-link:hover::before,
        .nav-link.active::before {
            width: 100%;
        }
        
        .nav-link:hover, .nav-link.active {
            color: #ffffff;
            transform: translateX(8px);
        }
        
        .nav-link i {
            width: 20px;
            text-align: center;
        }
        
        /* Ana İçerik Alanı */
        .main-content {
            margin-left: 280px;
            flex: 1;
            min-height: 100vh;
            transition: all 0.3s ease;
        }
        
        .top-bar {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 20px 32px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .top-bar-left {
            flex: 1;
            display: flex;
            align-items: center;
        }
        
        .mobile-menu-btn {
            display: none;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #ffffff;
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
            margin-right: 15px;
            transition: all 0.3s ease;
        }
        
        .mobile-menu-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }
        
        .page-title {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(135deg, #ffffff 0%, #e2e8f0 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .top-bar-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .balance-display {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            padding: 12px 20px;
            border-radius: 16px;
            font-weight: 700;
            font-size: 15px;
            box-shadow: 0 4px 20px rgba(59, 130, 246, 0.3);
            transition: all 0.3s ease;
        }
        
        .balance-display:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(59, 130, 246, 0.4);
        }
        
        .user-menu {
            position: relative;
        }
        
        .user-avatar {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-weight: 700;
            font-size: 18px;
            box-shadow: 0 4px 20px rgba(59, 130, 246, 0.3);
            transition: all 0.3s ease;
        }
        
        .user-avatar:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 30px rgba(59, 130, 246, 0.4);
        }
        
        .logout-btn {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(239, 68, 68, 0.3);
        }
        
        .logout-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(239, 68, 68, 0.4);
        }
        
        /* İçerik Alanı */
        .content-area {
            padding: 32px;
            min-height: calc(100vh - 80px);
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .content-section {
            display: none;
        }
        
        .content-section.active {
            display: block;
        }
        
        .section-header {
            margin-bottom: 30px;
        }
        
        .section-title {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 12px;
            background: linear-gradient(135deg, #ffffff 0%, #e2e8f0 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .section-subtitle {
            color: #8b8fa3;
            font-size: 16px;
        }
        
        /* Kart Komponenti */
        .card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 28px;
            margin-bottom: 24px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }
        
        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.2);
            border-color: rgba(255, 255, 255, 0.2);
        }
        
        .card-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .card-title {
            font-size: 20px;
            font-weight: 700;
            background: linear-gradient(135deg, #ffffff 0%, #e2e8f0 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        /* Grid Layout */
        .grid {
            display: grid;
            gap: 24px;
        }
        
        .grid-2 {
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
        }
        
        .grid-3 {
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        }
        
        /* Loading Spinner */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 60px;
            color: #94a3b8;
        }
        
        .spinner {
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 12px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .card {
            animation: fadeInUp 0.6s ease-out;
        }
        
        .nav-link {
            animation: slideInLeft 0.4s ease-out;
        }
        
        .nav-link:nth-child(1) { animation-delay: 0.1s; }
        .nav-link:nth-child(2) { animation-delay: 0.2s; }
        .nav-link:nth-child(3) { animation-delay: 0.3s; }
        .nav-link:nth-child(4) { animation-delay: 0.4s; }
        .nav-link:nth-child(5) { animation-delay: 0.5s; }
        .nav-link:nth-child(6) { animation-delay: 0.6s; }
        .nav-link:nth-child(7) { animation-delay: 0.7s; }
        
                /* Modern Market Container Styles */
        .modern-market-container {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.05) 0%, rgba(255, 255, 255, 0.02) 100%);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            padding: 0;
            margin-bottom: 24px;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
        }

        .market-header {
            background: linear-gradient(135deg, #1e2742 0%, #2a3f5f 100%);
            padding: 24px 32px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.08);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .market-title-section h3.market-title {
            color: #ffffff;
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .market-title-section h3.market-title i {
            color: #4fc3f7;
            font-size: 20px;
        }

        .market-subtitle {
            color: #8896ab;
            font-size: 14px;
            margin: 0;
        }

        .market-controls {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .search-container {
            position: relative;
            display: flex;
            align-items: center;
        }

        .search-container i {
            position: absolute;
            left: 16px;
            color: #8896ab;
            font-size: 14px;
            z-index: 2;
        }

        .search-container input {
            padding: 12px 16px 12px 44px;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 12px;
            color: #ffffff;
            font-size: 14px;
            width: 280px;
            transition: all 0.3s ease;
        }

        .search-container input:focus {
            outline: none;
            border-color: #4fc3f7;
            box-shadow: 0 0 0 3px rgba(79, 195, 247, 0.15);
            background: rgba(255, 255, 255, 0.12);
        }

        .search-container input::placeholder {
            color: #8896ab;
        }

        .refresh-btn {
            background: linear-gradient(135deg, #4fc3f7 0%, #29b6f6 100%);
            color: #ffffff;
            border: none;
            padding: 12px 20px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(79, 195, 247, 0.3);
        }

        .refresh-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(79, 195, 247, 0.4);
        }

        .refresh-btn i {
            font-size: 14px;
        }

        .market-filters {
            padding: 20px 32px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.08);
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .filter-chip {
            background: rgba(255, 255, 255, 0.05);
            color: #8896ab;
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 10px 18px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 13px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .filter-chip:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #ffffff;
            transform: translateY(-1px);
        }

        .filter-chip.active {
            background: linear-gradient(135deg, #4fc3f7 0%, #29b6f6 100%);
            color: #ffffff;
            border-color: #4fc3f7;
            box-shadow: 0 4px 15px rgba(79, 195, 247, 0.3);
        }

        .filter-chip i {
            font-size: 12px;
        }

        /* Modern Loading Animation */
        .modern-loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 60px 20px;
            color: #8896ab;
        }

        .loading-animation {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
        }

        .loading-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: linear-gradient(135deg, #4fc3f7 0%, #29b6f6 100%);
            animation: loadingPulse 1.4s ease-in-out infinite both;
        }

        .loading-dot:nth-child(1) { animation-delay: -0.32s; }
        .loading-dot:nth-child(2) { animation-delay: -0.16s; }
        .loading-dot:nth-child(3) { animation-delay: 0s; }

        @keyframes loadingPulse {
            0%, 80%, 100% {
                transform: scale(0.8);
                opacity: 0.5;
            }
            40% {
                transform: scale(1.2);
                opacity: 1;
            }
        }

        /* Desktop Coins Grid */
        .desktop-coins-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 20px;
            padding: 32px;
        }

        .desktop-coin-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.08) 0%, rgba(255, 255, 255, 0.04) 100%);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 24px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        .desktop-coin-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, #4fc3f7, #29b6f6, #00d4aa);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .desktop-coin-card:hover::before {
            transform: scaleX(1);
        }

        .desktop-coin-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.2);
            border-color: rgba(79, 195, 247, 0.3);
        }

        .coin-card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .coin-info {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .coin-logo {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: linear-gradient(135deg, #4fc3f7 0%, #29b6f6 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 18px;
            flex-shrink: 0;
            position: relative;
            overflow: hidden;
        }

        .coin-logo img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .coin-details h4 {
            color: #ffffff;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .coin-symbol {
            color: #8896ab;
            font-size: 14px;
            text-transform: uppercase;
            font-weight: 500;
        }

        .coin-price {
            text-align: right;
        }

        .coin-price .price {
            color: #ffffff;
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .coin-price .rank {
            background: rgba(136, 150, 171, 0.2);
            color: #8896ab;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .coin-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .price-change {
            padding: 8px 16px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .price-change.positive {
            background: rgba(76, 175, 80, 0.15);
            color: #4caf50;
            border: 1px solid rgba(76, 175, 80, 0.2);
        }

        .price-change.negative {
            background: rgba(244, 67, 54, 0.15);
            color: #f44336;
            border: 1px solid rgba(244, 67, 54, 0.2);
        }

        .volume-info {
            color: #8896ab;
            font-size: 13px;
            font-weight: 500;
        }

        .coin-actions {
            display: flex;
            gap: 12px;
        }

        .trade-btn {
            flex: 1;
            padding: 12px 16px;
            border: none;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            min-height: 44px;
        }

        .trade-btn.buy {
            background: linear-gradient(135deg, #4caf50 0%, #388e3c 100%);
            color: #ffffff;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
        }

        .trade-btn.sell {
            background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);
            color: #ffffff;
            box-shadow: 0 4px 15px rgba(244, 67, 54, 0.3);
        }

        .trade-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .trade-btn i {
            font-size: 12px;
        }

        /* Legacy Market Table Styles */
        .market-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .add-to-portfolio-btn {
            background: linear-gradient(135deg, #00d4aa 0%, #00a87a 100%);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 14px;
        }
        
        .add-to-portfolio-btn:hover {
            background: linear-gradient(135deg, #00a87a 0%, #008a66 100%);
            transform: translateY(-1px);
        }
        
        tbody tr {
            border-bottom: 1px solid #1a1f2e;
            transition: background-color 0.2s ease;
        }
        
        tbody tr:hover {
            background-color: #1a1f2e;
        }
        
        /* Professional Trading Platform Styles */
        .trading-container {
            background: linear-gradient(135deg, #0a0e1a 0%, #1a1f2e 100%);
            border-radius: 16px;
            padding: 0;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }
        
        .trading-header {
            background: linear-gradient(135deg, #1e2742 0%, #2a3f5f 100%);
            padding: 20px 24px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .trading-title {
            color: #ffffff;
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 8px;
            background: linear-gradient(135deg, #4fc3f7 0%, #29b6f6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .trading-subtitle {
            color: #8896ab;
            font-size: 14px;
            font-weight: 500;
        }
        
        .trading-filters {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-top: 16px;
        }
        
        .filter-btn {
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.05);
            color: #8896ab;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .filter-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #ffffff;
            transform: translateY(-1px);
        }
        
        .filter-btn.active {
            background: linear-gradient(135deg, #4fc3f7 0%, #29b6f6 100%);
            color: #ffffff;
            border-color: #29b6f6;
            box-shadow: 0 4px 12px rgba(79, 195, 247, 0.3);
        }
        
        .trading-panel {
            background: linear-gradient(135deg, #141927 0%, #1e2742 100%);
            border-radius: 12px;
            margin: 16px;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        .panel-header {
            background: linear-gradient(135deg, #2a3f5f 0%, #1e2742 100%);
            padding: 16px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.08);
        }
        
        .panel-title {
            color: #ffffff;
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 4px;
        }
        
        .panel-subtitle {
            color: #8896ab;
            font-size: 13px;
        }
        
        .trade-direction-container {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            padding: 0 4px;
        }
        
        .trade-direction-btn {
            flex: 1;
            padding: 16px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.05) 0%, rgba(255, 255, 255, 0.02) 100%);
            color: #8896ab;
            border-radius: 12px;
            font-weight: 700;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            backdrop-filter: blur(10px);
        }
        
        .trade-direction-btn::before {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: 10px;
            padding: 2px;
            background: linear-gradient(135deg, transparent 0%, rgba(255, 255, 255, 0.1) 100%);
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: subtract;
        }
        
        .trade-direction-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }
        
        .trade-direction-btn.active {
            background: linear-gradient(135deg, #4caf50 0%, #388e3c 100%);
            border-color: #4caf50;
            color: #ffffff;
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.4);
        }
        
        .trade-direction-btn.active[data-direction="short"] {
            background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);
            border-color: #f44336;
            box-shadow: 0 8px 25px rgba(244, 67, 54, 0.4);
        }
        
        .trading-form-group {
            margin-bottom: 20px;
        }
        
        .trading-label {
            display: block;
            color: #8896ab;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .trading-input, .trading-select {
            width: 100%;
            padding: 12px 16px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.08) 0%, rgba(255, 255, 255, 0.04) 100%);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #ffffff;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .trading-input:focus, .trading-select:focus {
            outline: none;
            border-color: #4fc3f7;
            box-shadow: 0 0 0 3px rgba(79, 195, 247, 0.1);
            background: linear-gradient(135deg, rgba(79, 195, 247, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
        }
        
        .trade-calculation-panel {
            background: linear-gradient(135deg, rgba(79, 195, 247, 0.1) 0%, rgba(41, 182, 246, 0.05) 100%);
            border: 1px solid rgba(79, 195, 247, 0.2);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
            backdrop-filter: blur(20px);
        }
        
        .calculation-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .calculation-row:last-child {
            margin-bottom: 0;
            border-bottom: none;
        }
        
        .calculation-label {
            color: #8896ab;
            font-size: 13px;
            font-weight: 600;
        }
        
        .calculation-value {
            color: #ffffff;
            font-size: 14px;
            font-weight: 700;
        }
        
        .calculation-value.positive {
            color: #4caf50;
        }
        
        .calculation-value.negative {
            color: #f44336;
        }
        
        .trade-open-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #4fc3f7 0%, #29b6f6 100%);
            color: #ffffff;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
        }
        
        .trade-open-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }
        
        .trade-open-btn:hover::before {
            left: 100%;
        }
        
        .trade-open-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(79, 195, 247, 0.4);
        }
        
        .trade-open-btn:disabled {
            background: linear-gradient(135deg, #2a2f3e 0%, #1a1f2e 100%);
            color: #8896ab;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .forex-pair-item {
            padding: 16px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .forex-pair-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 0;
            background: linear-gradient(135deg, #4fc3f7 0%, #29b6f6 100%);
            transition: width 0.3s ease;
        }
        
        .forex-pair-item:hover {
            background: linear-gradient(135deg, rgba(79, 195, 247, 0.05) 0%, rgba(41, 182, 246, 0.02) 100%);
            transform: translateX(4px);
        }
        
        .forex-pair-item:hover::before {
            width: 4px;
        }
        
        .forex-pair-item.selected {
            background: linear-gradient(135deg, rgba(79, 195, 247, 0.15) 0%, rgba(41, 182, 246, 0.08) 100%);
            transform: translateX(8px);
        }
        
        .forex-pair-item.selected::before {
            width: 4px;
        }
        
        .pair-symbol {
            font-size: 16px;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 4px;
        }
        
        .pair-category {
            font-size: 12px;
            color: #8896ab;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .pair-price {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 4px;
        }
        
        .pair-spread {
            font-size: 12px;
            color: #8896ab;
        }
        
        .price-up {
            color: #4caf50;
        }
        
        .price-down {
            color: #f44336;
        }
        
        .position-item {
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            margin-bottom: 12px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.05) 0%, rgba(255, 255, 255, 0.02) 100%);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        
        .position-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }
        
        .position-item.profit {
            border-left: 4px solid #4caf50;
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.1) 0%, rgba(76, 175, 80, 0.05) 100%);
        }
        
        .position-item.loss {
            border-left: 4px solid #f44336;
            background: linear-gradient(135deg, rgba(244, 67, 54, 0.1) 0%, rgba(244, 67, 54, 0.05) 100%);
        }
        
        .no-selection-message {
            text-align: center;
            padding: 60px 40px;
            color: #8896ab;
        }
        
                 .no-selection-icon {
             font-size: 64px;
             margin-bottom: 20px;
             opacity: 0.3;
             background: linear-gradient(135deg, #4fc3f7 0%, #29b6f6 100%);
             -webkit-background-clip: text;
             -webkit-text-fill-color: transparent;
         }
         
         /* Trading Modal Styles */
         .trading-modal {
             position: fixed;
             top: 0;
             left: 0;
             width: 100%;
             height: 100%;
             z-index: 10000;
             display: flex;
             align-items: center;
             justify-content: center;
             padding: 20px;
         }
         
         .modal-overlay {
             position: absolute;
             top: 0;
             left: 0;
             width: 100%;
             height: 100%;
             background: rgba(0, 0, 0, 0.85);
             backdrop-filter: blur(15px);
         }
         
         .modal-container {
             position: relative;
             width: 100%;
             height: auto;
             max-width: 600px;
             max-height: 90vh;
             background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
             border-radius: 20px;
             overflow: hidden;
             box-shadow: 0 30px 60px rgba(0, 0, 0, 0.6);
             border: 1px solid rgba(255, 255, 255, 0.1);
             transform: scale(0.95);
             opacity: 0;
             transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
         }
         
         .modal-header {
             background: linear-gradient(135deg, #1e2742 0%, #2a3f5f 100%);
             padding: 20px 24px;
             border-bottom: 1px solid rgba(255, 255, 255, 0.1);
             display: flex;
             justify-content: space-between;
             align-items: center;
         }
         
         .modal-title-section h2 {
             color: #ffffff;
             font-size: 24px;
             font-weight: 700;
             margin-bottom: 8px;
         }
         
         .modal-coin-info {
             display: flex;
             gap: 16px;
             align-items: center;
         }
         
         .modal-coin-info span {
             font-size: 14px;
             font-weight: 600;
         }
         
         #modalCoinSymbol {
             color: #8896ab;
             background: rgba(255, 255, 255, 0.1);
             padding: 4px 8px;
             border-radius: 4px;
         }
         
         #modalCoinPrice {
             color: #ffffff;
             font-size: 18px;
         }
         
         .price-change {
             padding: 4px 8px;
             border-radius: 4px;
             font-weight: 700;
         }
         
         .price-change.positive {
             background: rgba(76, 175, 80, 0.2);
             color: #4caf50;
         }
         
         .price-change.negative {
             background: rgba(244, 67, 54, 0.2);
             color: #f44336;
         }
         
         .modal-close-btn {
             background: rgba(255, 255, 255, 0.1);
             border: 1px solid rgba(255, 255, 255, 0.2);
             color: #8896ab;
             width: 40px;
             height: 40px;
             border-radius: 8px;
             cursor: pointer;
             transition: all 0.3s ease;
         }
         
         .modal-close-btn:hover {
             background: rgba(244, 67, 54, 0.2);
             border-color: #f44336;
             color: #f44336;
         }
         
         .modal-content {
             display: flex;
             flex-direction: column;
             height: calc(100% - 80px);
             overflow: hidden;
         }
         
         /* Modern Trade Panel */
         .modern-trade-panel {
             display: flex;
             flex-direction: column;
             height: 100%;
             background: linear-gradient(135deg, #1a1f2e 0%, #2a2f3e 100%);
         }
         
                 /* Coin Info Header - Yeni Layout */
         .coin-info-header {
             background: linear-gradient(135deg, #1e2742 0%, #2a3f5f 100%);
             padding: 24px 32px;
             border-bottom: 1px solid rgba(255, 255, 255, 0.1);
             display: flex;
             justify-content: space-between;
            align-items: flex-start;
            gap: 30px;
        }
        
        .coin-left-section {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .coin-chart-section {
            flex-shrink: 0;
         }
         
         .coin-main-info {
             display: flex;
             align-items: center;
             gap: 20px;
         }
         
         .coin-avatar {
             width: 60px;
             height: 60px;
             background: linear-gradient(135deg, #f7931a 0%, #ff8c00 100%);
             border-radius: 50%;
             display: flex;
             align-items: center;
             justify-content: center;
             color: white;
             font-size: 24px;
             box-shadow: 0 4px 20px rgba(247, 147, 26, 0.3);
         }
         
         .coin-details h2 {
             color: #ffffff;
             font-size: 24px;
             font-weight: 700;
             margin-bottom: 8px;
         }
         
         .coin-symbol-badge {
             background: rgba(255, 255, 255, 0.1);
             color: #8896ab;
             padding: 4px 12px;
             border-radius: 12px;
             font-size: 14px;
             font-weight: 600;
             text-transform: uppercase;
         }
        
        /* Sol taraftaki para bilgileri */
        .coin-price-info-left {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .coin-price-info-left .current-price {
            font-size: 36px !important;
            font-weight: 700 !important;
            color: #ffffff !important;
            text-shadow: 0 2px 10px rgba(255, 255, 255, 0.2) !important;
            margin-bottom: 8px !important;
        }
        
        .coin-price-info-left .price-change {
            font-size: 16px !important;
            font-weight: 600 !important;
            padding: 6px 12px !important;
            border-radius: 6px !important;
            width: fit-content !important;
        }
        
        .price-stats {
            display: flex !important;
            gap: 25px !important;
            margin-top: 15px !important;
            padding: 10px 0 !important;
        }
        
        .stat-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .stat-label {
            color: #8b8fa3;
            font-size: 12px;
            font-weight: 600;
        }
        
                .stat-value {
            font-size: 16px !important;
            font-weight: 600 !important;
        }
        
        .stat-value.positive {
            color: #00d4aa !important;
        }
        
        .stat-value.negative {
            color: #ff6b6b !important;
         }
         
         .coin-price-section {
             display: flex;
             align-items: center;
             gap: 20px;
         }
         
         .coin-price-info {
             text-align: right;
         }
         
         .current-price {
             color: #ffffff;
             font-size: 28px;
             font-weight: 700;
             margin-bottom: 8px;
         }
         
         /* Optimized Mini Chart Styles */
         .mini-chart-container {
             position: relative;
             width: 140px;
             height: 70px;
             background: linear-gradient(135deg, rgba(15, 23, 42, 0.95) 0%, rgba(30, 41, 59, 0.85) 100%);
             border-radius: 10px;
             border: 1px solid rgba(79, 195, 247, 0.15);
             overflow: hidden;
             display: flex;
             align-items: center;
             justify-content: center;
             box-shadow: 
                 0 4px 12px rgba(0, 0, 0, 0.25),
                 inset 0 1px 0 rgba(255, 255, 255, 0.1);
             backdrop-filter: blur(8px);
         }
         
         #miniPriceChart {
             width: 100%;
             height: 100%;
             border-radius: 9px;
         }
         
         .chart-trend-indicator {
             position: absolute;
             top: 5px;
             right: 5px;
             width: 18px;
             height: 18px;
             border-radius: 50%;
             background: rgba(76, 175, 80, 0.25);
             display: flex;
             align-items: center;
             justify-content: center;
             backdrop-filter: blur(12px);
             border: 1px solid rgba(255, 255, 255, 0.1);
             box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
         }
         
         .trend-icon {
             font-size: 9px;
             color: #00E676;
             animation: trendPulse 2.5s ease-in-out infinite;
             text-shadow: 0 0 4px rgba(0, 230, 118, 0.6);
         }
         
         .trend-icon.down {
             color: #FF5252;
             text-shadow: 0 0 4px rgba(255, 82, 82, 0.6);
             transform: rotate(180deg);
         }
         
         @keyframes trendPulse {
             0%, 100% { opacity: 0.8; transform: scale(1); }
             50% { opacity: 1; transform: scale(1.15); }
         }
         
         /* Modern Trading Tabs */
         .modern-trading-tabs {
             display: flex;
             gap: 0;
             background: rgba(255, 255, 255, 0.05);
             border-radius: 16px;
             padding: 4px;
             margin: 20px 32px;
         }
         
         .modern-tab {
             flex: 1;
             display: flex;
             align-items: center;
             justify-content: center;
             gap: 10px;
             padding: 16px 24px;
             background: transparent;
             color: #8896ab;
             border: none;
             border-radius: 12px;
             font-size: 15px;
             font-weight: 600;
             cursor: pointer;
             transition: all 0.3s ease;
         }
         
         .modern-tab:hover {
             color: #ffffff;
             background: rgba(255, 255, 255, 0.1);
         }
         
         .modern-tab.active {
             background: linear-gradient(135deg, #4fc3f7 0%, #29b6f6 100%);
             color: #ffffff;
             box-shadow: 0 4px 15px rgba(79, 195, 247, 0.3);
         }
         
         .modern-tab i {
             font-size: 16px;
         }
         
         /* Grafik alanını küçült */
         .chart-panel {
             background: linear-gradient(135deg, #141927 0%, #1e2742 100%);
             border-right: 1px solid rgba(255, 255, 255, 0.1);
             max-height: 60vh;
             overflow: hidden;
         }
         
         /* Order content'e scroll ekle */
         .order-content {
             padding: 24px;
             flex: 1;
             overflow-y: auto;
             max-height: 70vh;
             scrollbar-width: thin;
             scrollbar-color: #00d4aa #1e293b;
         }
         
         .order-content::-webkit-scrollbar {
             width: 6px;
         }
         
         .order-content::-webkit-scrollbar-track {
             background: #1e293b;
             border-radius: 3px;
         }
         
         .order-content::-webkit-scrollbar-thumb {
             background: #00d4aa;
             border-radius: 3px;
         }
         
         .order-content::-webkit-scrollbar-thumb:hover {
             background: #00b894;
         }
         
         .chart-panel {
             background: linear-gradient(135deg, #141927 0%, #1e2742 100%);
             border-right: 1px solid rgba(255, 255, 255, 0.1);
             max-height: 60vh;
             overflow: hidden;
         }
         
         .chart-header {
             padding: 16px 20px;
             border-bottom: 1px solid rgba(255, 255, 255, 0.1);
         }
         
         .chart-controls {
             display: flex;
             justify-content: space-between;
             align-items: center;
         }
         
         .timeframe-buttons {
             display: flex;
             gap: 8px;
         }
         
         .timeframe-btn {
             padding: 8px 12px;
             background: rgba(255, 255, 255, 0.05);
             color: #8896ab;
             border: 1px solid rgba(255, 255, 255, 0.1);
             border-radius: 6px;
             font-size: 12px;
             font-weight: 600;
             cursor: pointer;
             transition: all 0.3s ease;
         }
         
         .timeframe-btn:hover, .timeframe-btn.active {
             background: linear-gradient(135deg, #4fc3f7 0%, #29b6f6 100%);
             border-color: #4fc3f7;
             color: #ffffff;
         }
         
         .chart-tools {
             display: flex;
             gap: 8px;
         }
         
         .tool-btn {
             padding: 8px;
             background: rgba(255, 255, 255, 0.05);
             color: #8896ab;
             border: 1px solid rgba(255, 255, 255, 0.1);
             border-radius: 6px;
             cursor: pointer;
             transition: all 0.3s ease;
         }
         
         .tool-btn:hover {
             background: rgba(255, 255, 255, 0.1);
             color: #ffffff;
         }
         
         .chart-container {
             height: calc(100% - 70px);
             position: relative;
         }
         
         .chart-placeholder {
             height: 100%;
             display: flex;
             align-items: center;
             justify-content: center;
         }
         
         .chart-loading {
             text-align: center;
             color: #8896ab;
         }
         
         .chart-icon {
             font-size: 64px;
             margin-bottom: 20px;
             color: #4fc3f7;
         }
         
         .chart-loading h3 {
             color: #ffffff;
             margin-bottom: 12px;
         }
         
         .chart-features {
             margin-top: 24px;
             font-size: 14px;
             display: grid;
             grid-template-columns: 1fr 1fr;
             gap: 8px;
         }
         
         .order-panel {
             background: linear-gradient(135deg, #1a1f2e 0%, #2a2f3e 100%);
             display: flex;
             flex-direction: column;
         }
         
         .order-header {
             padding: 16px 20px;
             border-bottom: 1px solid rgba(255, 255, 255, 0.1);
         }
         
         .trading-tabs {
             display: flex;
             gap: 12px;
             padding: 16px 20px;
             border-bottom: 1px solid rgba(255, 255, 255, 0.1);
         }
         
         .trading-tab {
             display: flex;
             align-items: center;
             gap: 8px;
             padding: 12px 20px;
             background: rgba(255, 255, 255, 0.05);
             color: #8896ab;
             border: 1px solid rgba(255, 255, 255, 0.1);
             border-radius: 12px;
             font-size: 14px;
             font-weight: 600;
             cursor: pointer;
             transition: all 0.3s ease;
             min-width: 120px;
             justify-content: center;
         }
         
         .trading-tab i {
             font-size: 16px;
         }
         
         .trading-tab.active {
             background: linear-gradient(135deg, #00d4aa 0%, #00b894 100%);
             border-color: #00d4aa;
             color: #ffffff;
             box-shadow: 0 4px 15px rgba(0, 212, 170, 0.3);
         }
         
         .order-content {
             padding: 32px;
             flex: 1;
             overflow-y: auto;
             scrollbar-width: thin;
             scrollbar-color: #4fc3f7 #1e293b;
             background: linear-gradient(135deg, #1a1f2e 0%, #2a2f3e 100%);
         }
         
         .order-content::-webkit-scrollbar {
             width: 6px;
         }
         
         .order-content::-webkit-scrollbar-track {
             background: #1e293b;
             border-radius: 3px;
         }
         
         .order-content::-webkit-scrollbar-thumb {
             background: #4fc3f7;
             border-radius: 3px;
         }
         
         .order-content::-webkit-scrollbar-thumb:hover {
             background: #29b6f6;
         }
         
         .order-direction-toggle {
             display: grid;
             grid-template-columns: 1fr 1fr;
             gap: 16px;
             margin-bottom: 28px;
         }
         
         .direction-btn {
             display: flex;
             flex-direction: column;
             align-items: center;
             gap: 10px;
             padding: 28px 20px;
             border: 2px solid rgba(255, 255, 255, 0.15);
             background: rgba(255, 255, 255, 0.08);
             border-radius: 16px;
             cursor: pointer;
             transition: all 0.3s ease;
             text-align: center;
             position: relative;
             overflow: hidden;
             min-height: 120px;
         }
         
         .direction-btn::before {
             content: '';
             position: absolute;
             top: 0;
             left: -100%;
             width: 100%;
             height: 100%;
             background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
             transition: left 0.5s ease;
         }
         
         .direction-btn:hover::before {
             left: 100%;
         }
         
         .direction-btn i {
             font-size: 20px;
             margin-bottom: 4px;
         }
         
         .direction-btn .btn-text {
             display: block;
             font-weight: 700;
             font-size: 18px;
             margin-bottom: 4px;
         }
         
         .direction-btn .btn-subtitle {
             font-size: 13px;
             opacity: 0.8;
         }
         
         .buy-btn {
             color: #00d4aa;
         }
         
         .buy-btn.active {
             background: linear-gradient(135deg, #00d4aa 0%, #00b894 100%);
             border-color: #00d4aa;
             color: #ffffff;
             box-shadow: 0 8px 25px rgba(0, 212, 170, 0.3);
         }
         
         .sell-btn {
             color: #ff6b6b;
         }
         
         .sell-btn.active {
             background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
             border-color: #ff6b6b;
             color: #ffffff;
             box-shadow: 0 8px 25px rgba(255, 107, 107, 0.3);
         }
         
         .form-group {
             margin-bottom: 28px;
         }
         
         .form-label {
             display: block;
             color: #8896ab;
             font-size: 15px;
             font-weight: 600;
             margin-bottom: 12px;
             text-transform: uppercase;
             letter-spacing: 0.5px;
         }
         
         .form-select, .form-input {
             width: 100%;
             padding: 20px 24px;
             background: rgba(255, 255, 255, 0.08);
             border: 2px solid rgba(255, 255, 255, 0.15);
             border-radius: 16px;
             color: #ffffff;
             font-size: 16px;
             font-weight: 500;
             transition: all 0.3s ease;
             backdrop-filter: blur(10px);
             min-height: 56px;
         }
         
         .form-select:focus, .form-input:focus {
             outline: none;
             border-color: #00d4aa;
             box-shadow: 0 0 0 3px rgba(0, 212, 170, 0.1);
             background: rgba(255, 255, 255, 0.08);
         }
         
         .form-select:focus, .form-input:focus {
             outline: none;
             border-color: #4fc3f7;
             box-shadow: 0 0 0 3px rgba(79, 195, 247, 0.1);
         }
         
         .input-group {
             position: relative;
         }
         
         .input-suffix {
             position: absolute;
             right: 16px;
             top: 50%;
             transform: translateY(-50%);
             color: #8896ab;
             font-size: 14px;
             font-weight: 600;
         }
         
         .amount-tabs {
             display: flex;
             gap: 8px;
             margin-bottom: 12px;
         }
         
         .amount-tab {
             flex: 1;
             padding: 8px;
             background: rgba(255, 255, 255, 0.05);
             color: #8896ab;
             border: 1px solid rgba(255, 255, 255, 0.1);
             border-radius: 6px;
             font-size: 12px;
             font-weight: 600;
             cursor: pointer;
             transition: all 0.3s ease;
         }
         
         .amount-tab.active {
             background: #4fc3f7;
             border-color: #4fc3f7;
             color: #ffffff;
         }
         
         .percentage-buttons {
             display: grid;
             grid-template-columns: repeat(4, 1fr);
             gap: 8px;
             margin-top: 12px;
         }
         
         .amount-tabs {
             display: flex;
             gap: 8px;
             margin-bottom: 16px;
         }
         
         .amount-tab {
             display: flex;
             align-items: center;
             gap: 6px;
             padding: 10px 16px;
             background: rgba(255, 255, 255, 0.05);
             color: #8896ab;
             border: 1px solid rgba(255, 255, 255, 0.1);
             border-radius: 10px;
             font-size: 13px;
             font-weight: 600;
             cursor: pointer;
             transition: all 0.3s ease;
             flex: 1;
             justify-content: center;
         }
         
         .amount-tab.active {
             background: linear-gradient(135deg, #00d4aa 0%, #00b894 100%);
             border-color: #00d4aa;
             color: #ffffff;
             box-shadow: 0 4px 15px rgba(0, 212, 170, 0.3);
         }
         
         .percentage-buttons {
             display: grid;
             grid-template-columns: repeat(4, 1fr);
             gap: 8px;
             margin-top: 12px;
         }
         
         .percent-btn {
             padding: 12px 8px;
             background: rgba(255, 255, 255, 0.05);
             color: #8896ab;
             border: 1px solid rgba(255, 255, 255, 0.1);
             border-radius: 10px;
             font-size: 13px;
             font-weight: 600;
             cursor: pointer;
             transition: all 0.3s ease;
             text-align: center;
         }
         
         .percent-btn:hover {
             background: #00d4aa;
             border-color: #00d4aa;
             color: #ffffff;
             transform: translateY(-1px);
         }
         
         .order-summary {
             background: rgba(0, 212, 170, 0.1);
             border: 1px solid rgba(0, 212, 170, 0.2);
             border-radius: 12px;
             padding: 20px;
             margin-bottom: 24px;
         }
         
         .summary-row {
             display: flex;
             justify-content: space-between;
             margin-bottom: 12px;
             align-items: center;
         }
         
         .summary-row:last-child {
             margin-bottom: 0;
         }
         
         .summary-label {
             color: #8896ab;
             font-size: 14px;
         }
         
         .summary-value {
             color: #ffffff;
             font-weight: 600;
             font-size: 15px;
         }
         
         .execute-btn {
             width: 100%;
             padding: 24px 32px;
             border: none;
             border-radius: 16px;
             font-size: 18px;
             font-weight: 700;
             cursor: pointer;
             transition: all 0.3s ease;
             margin-bottom: 28px;
             display: flex;
             align-items: center;
             justify-content: center;
             gap: 12px;
             position: relative;
             overflow: hidden;
             min-height: 64px;
             text-transform: uppercase;
             letter-spacing: 1px;
         }
         
         .execute-btn::before {
             content: '';
             position: absolute;
             top: 0;
             left: -100%;
             width: 100%;
             height: 100%;
             background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
             transition: left 0.6s ease;
         }
         
         .execute-btn:hover::before {
             left: 100%;
         }
         
         .execute-btn.buy-order {
             background: linear-gradient(135deg, #00d4aa 0%, #00b894 100%);
             color: #ffffff;
             box-shadow: 0 8px 25px rgba(0, 212, 170, 0.3);
         }
         
         .execute-btn.sell-order {
             background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
             color: #ffffff;
             box-shadow: 0 8px 25px rgba(255, 107, 107, 0.3);
         }
         
         .execute-btn:hover:not(:disabled) {
             transform: translateY(-3px);
             box-shadow: 0 12px 35px rgba(0, 0, 0, 0.4);
         }
         
         .execute-btn:disabled {
             background: #2a2f3e;
             color: #8896ab;
             cursor: not-allowed;
             box-shadow: none;
         }
         
         .advanced-options {
             border-top: 1px solid rgba(255, 255, 255, 0.1);
             padding-top: 20px;
         }
         
         .advanced-toggle {
             width: 100%;
             background: none;
             border: none;
             color: #8896ab;
             font-size: 14px;
             font-weight: 600;
             padding: 12px 0;
             cursor: pointer;
             transition: color 0.3s ease;
         }
         
         .advanced-toggle:hover {
             color: #4fc3f7;
         }
         
         .advanced-content {
             margin-top: 16px;
         }
         
                         /* Mobile Responsive Styles */
        /* Desktop and Tablet Responsive */
        @media (min-width: 769px) {
            /* Desktop Coins Grid Styles */
            .desktop-coins-grid {
                display: grid !important;
            }
            
            .mobile-coins-grid {
                display: none !important;
            }
            
            .modern-market-container {
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
            }
        }

        @media (max-width: 1024px) {
            .sidebar {
                width: 260px;
            }
            
            .main-content {
                margin-left: 260px;
            }
            
            .grid-2 {
                grid-template-columns: 1fr;
            }
            
            .grid-3 {
                grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            }
            
            .desktop-coins-grid {
                grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)) !important;
                gap: 16px !important;
                padding: 24px !important;
            }
            
            .desktop-coin-card {
                padding: 20px !important;
            }
        }
        
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
                z-index: 1001;
                width: 280px;
            }
            
            .sidebar.mobile-open {
                transform: translateX(0);
            }
            
            .mobile-overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.7);
                backdrop-filter: blur(10px);
                z-index: 1000;
            }
            
            .mobile-overlay.active {
                display: block;
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .content-area {
                padding: 16px;
            }
            
            .top-bar {
                padding: 16px 20px;
            }
            
            .page-title {
                font-size: 24px;
            }
            
            .balance-display {
                padding: 10px 16px;
                font-size: 14px;
            }
            
            .user-avatar {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }
            
            .logout-btn {
                padding: 10px 16px;
                font-size: 14px;
            }
            
            .card {
                padding: 20px;
                margin-bottom: 16px;
            }
            
            .section-title {
                font-size: 28px;
            }
            
            .grid {
                gap: 16px;
            }
            
            .grid-2, .grid-3 {
                grid-template-columns: 1fr;
            }
           
           .card {
               margin: 0 !important;
               border-radius: 12px !important;
           }
           
           .card-header {
               padding: 16px !important;
           }
           
           .market-controls {
               flex-direction: column !important;
               gap: 12px !important;
               align-items: stretch !important;
           }
           
                   /* Modern Trading Modal Styles */
        .modern-trading-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .modal-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }
        
        .modal-container {
            background: linear-gradient(135deg, #1a1f2e 0%, #2a2f3e 100%);
            border-radius: 20px;
            width: 100%;
            max-width: 900px;
            max-height: 90vh;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            transform: scale(0.9);
            opacity: 0;
            transition: all 0.3s ease;
        }
        
        /* Modern Header */
        .modal-header-modern {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 24px 32px;
            background: linear-gradient(135deg, #2a3f5f 0%, #1e2742 100%);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .coin-basic-info {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        .coin-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #f7931a 0%, #ff8c00 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
            box-shadow: 0 4px 20px rgba(247, 147, 26, 0.3);
        }
        
        .coin-text h3 {
            color: #ffffff;
            font-size: 20px;
            font-weight: 700;
            margin: 0;
        }
        
        .coin-text span {
            color: #8896ab;
            font-size: 14px;
            font-weight: 600;
        }
        
        .price-display {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        
        .current-price-modern {
            color: #ffffff;
            font-size: 24px;
            font-weight: 700;
        }
        
        .price-change-modern {
            font-size: 14px;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: 6px;
            width: fit-content;
        }
        
        .price-change-modern.positive {
            background: rgba(0, 230, 118, 0.2);
            color: #00e676;
        }
        
        .price-change-modern.negative {
            background: rgba(255, 107, 107, 0.2);
            color: #ff6b6b;
        }
        
        .close-btn-modern {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: #ffffff;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .close-btn-modern:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }
        
        /* Modern Content */
        .modal-content-modern {
            padding: 32px;
            max-height: calc(90vh - 100px);
            overflow-y: auto;
        }
        
        /* Chart Section */
        .chart-section-modern {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .chart-header h4 {
            color: #ffffff;
            font-size: 18px;
            font-weight: 600;
            margin: 0;
        }
        
        .time-filters {
            display: flex;
            gap: 8px;
        }
        
        .time-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #8896ab;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .time-btn.active {
            background: #00d4aa;
            color: #ffffff;
            border-color: #00d4aa;
        }
        
        .chart-container-modern {
            width: 100%;
            height: 300px;
            margin-bottom: 20px;
            position: relative;
        }
        
        .chart-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
        }
        
        .stat-modern {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        
        .stat-modern .stat-label {
            color: #8896ab;
            font-size: 12px;
            font-weight: 500;
        }
        
        .stat-modern .stat-value {
            color: #ffffff;
            font-size: 16px;
            font-weight: 600;
        }
        
        .stat-modern .stat-value.positive {
            color: #00e676;
        }
        
        .stat-modern .stat-value.negative {
            color: #ff6b6b;
        }
        
        /* Trading Form */
        .trading-form-modern {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 16px;
            padding: 24px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .form-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }
        
        .form-header h4 {
            color: #ffffff;
            font-size: 18px;
            font-weight: 600;
            margin: 0;
        }
        
        .trade-type-toggle {
            display: flex;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 4px;
        }
        
        .trade-type-btn {
            background: transparent;
            border: none;
            color: #8896ab;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .trade-type-btn.active {
            background: #00d4aa;
            color: #ffffff;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 20px;
        }
        
        .form-group-modern {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .form-group-modern label {
            color: #8896ab;
            font-size: 14px;
            font-weight: 500;
        }
        
        .form-input-modern {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 12px 16px;
            color: #ffffff;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        .form-input-modern:focus {
            outline: none;
            border-color: #00d4aa;
            box-shadow: 0 0 0 3px rgba(0, 212, 170, 0.1);
        }
        
        .trade-btn-modern {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }
        
        .trade-btn-modern.buy {
            background: linear-gradient(135deg, #00e676 0%, #00d4aa 100%);
            color: #ffffff;
        }
        
        .trade-btn-modern.sell {
            background: linear-gradient(135deg, #ff6b6b 0%, #ff5252 100%);
            color: #ffffff;
        }
        
        .trade-btn-modern:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }
        
        .buy-sell-toggle {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .buy-sell-toggle .trade-btn-modern {
            margin-top: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 16px 12px;
        }
        
        .buy-sell-toggle .trade-btn-modern i {
            font-size: 18px;
        }
        
        .buy-sell-toggle .trade-btn-modern span {
            font-size: 14px;
            font-weight: 600;
        }
        
        .buy-sell-toggle .trade-btn-modern small {
            font-size: 12px;
            opacity: 0.8;
        }
        
        /* Mobile Responsive */
        @media (max-width: 768px) {
            .modern-trading-modal {
                padding: 5px !important;
                align-items: flex-end !important;
            }
            
            .modal-container {
                max-height: 98vh !important;
                width: 100% !important;
                border-radius: 20px 20px 0 0 !important;
                margin-bottom: 0 !important;
            }
            
            .modal-header-modern {
                padding: 16px 20px !important;
                flex-direction: column !important;
                gap: 16px !important;
            }
            
            .header-left {
                flex-direction: row !important;
                align-items: center !important;
                gap: 12px !important;
                width: 100% !important;
            }
            
            .coin-basic-info {
                flex: 1 !important;
            }
            
            .price-display {
                flex-direction: row !important;
                align-items: center !important;
                gap: 12px !important;
            }
            
            .current-price-modern {
                font-size: 20px !important;
            }
            
            .price-change-modern {
                font-size: 12px !important;
            }
            
            .header-right {
                align-self: flex-end !important;
            }
            
            .modal-content-modern {
                padding: 16px 20px !important;
                max-height: calc(98vh - 120px) !important;
                overflow-y: auto !important;
            }
            
            .chart-section-modern {
                padding: 16px !important;
                margin-bottom: 16px !important;
            }
            
            .chart-header {
                flex-direction: column !important;
                gap: 12px !important;
                align-items: flex-start !important;
            }
            
            .time-filters {
                width: 100% !important;
                justify-content: space-between !important;
            }
            
            .time-btn {
                flex: 1 !important;
                text-align: center !important;
                padding: 8px 4px !important;
                font-size: 11px !important;
            }
            
            .chart-container-modern {
                height: 180px !important;
                margin-bottom: 16px !important;
            }
            
            .chart-stats {
                grid-template-columns: repeat(3, 1fr) !important;
                gap: 8px !important;
            }
            
            .stat-modern .stat-label {
                font-size: 10px !important;
            }
            
            .stat-modern .stat-value {
                font-size: 14px !important;
            }
            
            .trading-form-modern {
                padding: 16px !important;
            }
            
            .form-header {
                flex-direction: column !important;
                gap: 12px !important;
                align-items: flex-start !important;
            }
            
            .trade-type-toggle {
                width: 100% !important;
                justify-content: space-between !important;
            }
            
            .trade-type-btn {
                flex: 1 !important;
                text-align: center !important;
                padding: 10px 8px !important;
                font-size: 13px !important;
            }
            
            .form-row {
                grid-template-columns: 1fr !important;
                gap: 12px !important;
                margin-bottom: 16px !important;
            }
            
            .form-group-modern label {
                font-size: 13px !important;
            }
            
            .form-input-modern {
                padding: 12px 14px !important;
                font-size: 16px !important;
            }
            
            .trade-btn-modern {
                padding: 14px !important;
                font-size: 15px !important;
                margin-top: 16px !important;
            }
            
            .buy-sell-toggle {
                gap: 8px !important;
                margin-bottom: 16px !important;
            }
            
            .buy-sell-toggle .trade-btn-modern {
                padding: 12px 8px !important;
            }
            
            .buy-sell-toggle .trade-btn-modern i {
                font-size: 16px !important;
            }
            
            .buy-sell-toggle .trade-btn-modern span {
                font-size: 13px !important;
            }
            
            .buy-sell-toggle .trade-btn-modern small {
                font-size: 11px !important;
            }
        }
        
        /* Extra Small Mobile */
        @media (max-width: 480px) {
            .modern-trading-modal {
                padding: 0 !important;
            }
            
            .modal-container {
                border-radius: 16px 16px 0 0 !important;
                max-height: 100vh !important;
            }
            
            .modal-header-modern {
                padding: 12px 16px !important;
            }
            
            .header-left {
                gap: 8px !important;
            }
            
            .coin-icon {
                width: 40px !important;
                height: 40px !important;
                font-size: 16px !important;
            }
            
            .coin-text h3 {
                font-size: 16px !important;
            }
            
            .coin-text span {
                font-size: 12px !important;
            }
            
            .current-price-modern {
                font-size: 18px !important;
            }
            
            .modal-content-modern {
                padding: 12px 16px !important;
            }
            
            .chart-container-modern {
                height: 150px !important;
            }
            
            .time-btn {
                font-size: 10px !important;
                padding: 6px 2px !important;
            }
            
            .chart-stats {
                grid-template-columns: 1fr !important;
                gap: 8px !important;
            }
            
            .stat-modern {
                flex-direction: row !important;
                justify-content: space-between !important;
                align-items: center !important;
            }
            
            .buy-sell-toggle .trade-btn-modern {
                padding: 10px 6px !important;
            }
            
            .buy-sell-toggle .trade-btn-modern i {
                font-size: 14px !important;
            }
            
            .buy-sell-toggle .trade-btn-modern span {
                font-size: 12px !important;
            }
            
            .buy-sell-toggle .trade-btn-modern small {
                font-size: 10px !important;
            }
        }
           
           .modal-container {
               width: 100%;
               height: 95vh;
               max-height: 95vh;
               max-width: none;
               border-radius: 16px;
               margin: 0;
           }
           
           .modal-content {
               height: calc(100% - 70px);
           }
           
           .coin-info-header {
               padding: 16px 20px !important;
               flex-direction: column !important;
               align-items: flex-start !important;
               gap: 12px !important;
           }
          
          .coin-chart-section {
              width: 100% !important;
              margin-top: 15px !important;
           }
           
           .coin-price-section {
               width: 100% !important;
               justify-content: space-between !important;
               gap: 12px !important;
           }
           
           .mini-chart-container {
               width: 120px !important;
               height: 65px !important;
           }
           
           #chart-container {
               width: 140px !important;
               height: 75px !important;
           }
           
           .coin-main-info {
               gap: 16px !important;
           }
           
           .coin-avatar {
               width: 50px !important;
               height: 50px !important;
               font-size: 20px !important;
           }
           
           .coin-details h2 {
               font-size: 20px !important;
               margin-bottom: 6px !important;
           }
           
           .current-price {
               font-size: 24px !important;
           }
           
           .modern-trading-tabs {
               margin: 16px 20px !important;
               padding: 3px !important;
           }
           
           .modern-tab {
               padding: 14px 20px !important;
               font-size: 14px !important;
           }
           
           .chart-panel {
               border-right: none;
               border-bottom: 1px solid rgba(255, 255, 255, 0.1);
               max-height: 40vh;
           }
           
           .order-content {
               padding: 20px !important;
               font-size: 14px;
           }
           
           .form-group {
               margin-bottom: 20px !important;
           }
           
           .form-select, .form-input {
               padding: 16px 20px !important;
               font-size: 15px !important;
               min-height: 50px !important;
           }
           
           .direction-btn {
               padding: 20px 16px !important;
               min-height: 100px !important;
           }
           
           .execute-btn {
               padding: 18px 24px !important;
               font-size: 16px !important;
               min-height: 56px !important;
           }
           
           .chart-header {
               padding: 12px 16px;
           }
           
           .timeframe-buttons {
               gap: 6px;
           }
           
           .timeframe-btn {
               padding: 8px 12px;
               font-size: 12px;
           }
           
           .order-content {
               padding: 16px;
           }
           
           .order-direction-toggle {
               gap: 12px;
               margin-bottom: 20px;
           }
           
           .direction-btn {
               padding: 16px 12px;
           }
           
           .direction-btn .btn-text {
               font-size: 16px;
           }
           
           .direction-btn i {
               font-size: 18px;
           }
           
           .form-group {
               margin-bottom: 20px;
           }
           
           .form-input, .form-select {
               padding: 14px 16px;
               font-size: 14px;
           }
           
           .amount-tabs {
               gap: 6px;
           }
           
           .amount-tab {
               padding: 8px 12px;
               font-size: 12px;
           }
           
           .percentage-buttons {
               gap: 6px;
           }
           
           .percent-btn {
               padding: 10px 6px;
               font-size: 12px;
           }
           
           .order-summary {
               padding: 16px;
               margin-bottom: 20px;
           }
           
           .execute-btn {
               padding: 18px;
               font-size: 15px;
               margin-bottom: 20px;
           }
           
           .trading-tabs {
               padding: 12px 16px;
               gap: 8px;
           }
           
                       .trading-tab {
                padding: 10px 16px;
                font-size: 13px;
                min-width: 100px;
            }
           
           .market-controls input {
               width: 100% !important;
               max-width: none !important;
               box-sizing: border-box !important;
           }
           
           .market-controls button {
               width: 100% !important;
               margin-left: 0 !important;
               justify-content: center !important;
           }
           
           .grid-2, .grid-3 {
               grid-template-columns: 1fr;
           }
           
           /* Trading Modal Mobile Optimization */
           .modal-container {
               width: 98%;
               height: 95%;
               max-width: none;
           }
           
           .modal-content {
               grid-template-columns: 1fr;
               grid-template-rows: 1fr auto;
               overflow: hidden;
           }
           
           .chart-panel {
               border-right: none;
               border-bottom: 1px solid rgba(255, 255, 255, 0.1);
               min-height: 280px;
               height: auto;
           }
           
           .order-panel {
               min-height: auto;
               max-height: 50vh;
               overflow-y: auto;
           }
           
           .chart-header {
               padding: 12px 16px;
           }
           
           .timeframe-buttons {
               gap: 4px;
               flex-wrap: wrap;
           }
           
           .timeframe-btn {
               padding: 6px 8px;
               font-size: 11px;
           }
           
           .chart-tools {
               gap: 4px;
           }
           
           .tool-btn {
               padding: 6px;
               font-size: 12px;
           }
           
           .order-content {
               padding: 16px;
           }
           
           .order-direction-toggle {
               grid-template-columns: 1fr 1fr;
               gap: 8px;
               margin-bottom: 20px;
           }
           
           .direction-btn {
               padding: 12px;
           }
           
           .direction-btn .btn-text {
               font-size: 14px;
           }
           
           .direction-btn .btn-subtitle {
               font-size: 11px;
           }
           
           .form-group {
               margin-bottom: 16px;
           }
           
           .form-label {
               font-size: 13px;
               margin-bottom: 6px;
           }
           
           .form-select, .form-input {
               padding: 10px 12px;
               font-size: 13px;
           }
           
           .percentage-buttons {
               grid-template-columns: repeat(4, 1fr);
               gap: 6px;
               margin-top: 10px;
           }
           
           .percent-btn {
               padding: 6px;
               font-size: 11px;
           }
           
           .order-summary {
               padding: 12px;
               margin-bottom: 16px;
           }
           
           .summary-row {
               margin-bottom: 6px;
           }
           
           .summary-label, .summary-value {
               font-size: 13px;
           }
           
           .execute-btn {
               padding: 14px;
               font-size: 15px;
               margin-bottom: 16px;
           }
           
           .advanced-toggle {
               padding: 10px 0;
               font-size: 13px;
           }
           
           /* Mobile Modern Market Styles */
           .modern-market-container {
               border-radius: 16px !important;
               margin: 0 !important;
           }
           
           .market-header {
               padding: 16px 20px !important;
               flex-direction: column !important;
               align-items: stretch !important;
               gap: 16px !important;
           }
           
           .market-title-section h3.market-title {
               font-size: 18px !important;
               margin-bottom: 6px !important;
           }
           
           .market-subtitle {
               font-size: 13px !important;
           }
           
           .market-controls {
               flex-direction: column !important;
               gap: 12px !important;
           }
           
           .search-container {
               width: 100% !important;
           }
           
           .search-container input {
               width: 100% !important;
               box-sizing: border-box !important;
           }
           
           .refresh-btn {
               width: 100% !important;
               justify-content: center !important;
               padding: 14px 20px !important;
           }
           
           .market-filters {
               padding: 16px 20px !important;
               gap: 8px !important;
           }
           
           .filter-chip {
               padding: 8px 14px !important;
               font-size: 12px !important;
           }
           
           /* Desktop Coins Grid - Hide on Mobile */
           .desktop-coins-grid {
               display: none !important;
           }
           
           /* Mobile Coins Grid - Enhanced */
           .mobile-coins-grid {
               display: grid !important;
               grid-template-columns: 1fr;
               gap: 12px;
               padding: 20px;
               margin: 0;
               width: 100%;
               box-sizing: border-box;
           }
           
           .mobile-coin-card {
               background: linear-gradient(135deg, rgba(255, 255, 255, 0.08) 0%, rgba(255, 255, 255, 0.04) 100%);
               border: 1px solid rgba(255, 255, 255, 0.1);
               border-radius: 16px;
               padding: 20px;
               position: relative;
               overflow: hidden;
               width: 100%;
               box-sizing: border-box;
               min-height: 140px;
               transition: all 0.3s ease;
               backdrop-filter: blur(10px);
           }
           
           .mobile-coin-card:active {
               transform: scale(0.98);
           }
           
           .mobile-coin-header {
               display: flex;
               align-items: center;
               justify-content: space-between;
               margin-bottom: 12px;
           }
           
           .mobile-coin-info {
               display: flex;
               align-items: center;
               gap: 12px;
           }
           
           .mobile-coin-logo {
               width: 50px;
               height: 50px;
               border-radius: 50%;
               background: linear-gradient(135deg, #4fc3f7 0%, #29b6f6 100%);
               display: flex;
               align-items: center;
               justify-content: center;
               color: white;
               font-weight: bold;
               font-size: 20px;
               flex-shrink: 0;
           }
           
           .mobile-coin-details h3 {
               color: #ffffff;
               font-size: 18px;
               font-weight: 600;
               margin-bottom: 6px;
           }
           
           .mobile-coin-details .coin-symbol {
               color: #8896ab;
               font-size: 14px;
               text-transform: uppercase;
               font-weight: 500;
           }
           
           .mobile-coin-price {
               color: #ffffff;
               font-size: 20px;
               font-weight: 700;
               text-align: right;
           }
           
           .mobile-coin-stats {
               display: flex;
               justify-content: space-between;
               align-items: center;
               margin-bottom: 16px;
           }
           
           .mobile-coin-change {
               padding: 6px 12px;
               border-radius: 8px;
               font-size: 14px;
               font-weight: 600;
           }
           
           .mobile-coin-change.positive {
               background: rgba(76, 175, 80, 0.2);
               color: #4caf50;
           }
           
           .mobile-coin-change.negative {
               background: rgba(244, 67, 54, 0.2);
               color: #f44336;
           }
           
           .mobile-coin-volume {
               color: #8896ab;
               font-size: 13px;
               font-weight: 500;
           }
           
           .mobile-coin-actions {
               display: flex;
               gap: 12px;
           }
           
           .mobile-trade-btn {
               flex: 1;
               padding: 14px;
               border: none;
               border-radius: 10px;
               font-size: 15px;
               font-weight: 600;
               cursor: pointer;
               transition: all 0.3s ease;
               min-height: 48px;
               display: flex;
               align-items: center;
               justify-content: center;
               gap: 6px;
           }
           
           .mobile-trade-btn.buy {
               background: linear-gradient(135deg, #4caf50 0%, #388e3c 100%);
               color: #ffffff;
           }
           
           .mobile-trade-btn.sell {
               background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);
               color: #ffffff;
           }
           
           .mobile-trade-btn:active {
               transform: scale(0.98);
           }
           
           /* Mobile Forex Trading Optimization */
           .trading-container {
               margin: 16px !important;
               border-radius: 12px !important;
           }
           
           .trading-header {
               padding: 16px !important;
           }
           
           .trading-title {
               font-size: 18px !important;
               margin-bottom: 8px !important;
           }
           
           .trading-subtitle {
               font-size: 12px !important;
           }
           
           .trading-filters {
               margin-top: 12px !important;
               gap: 6px !important;
               flex-wrap: wrap !important;
           }
           
           .filter-btn {
               padding: 6px 10px !important;
               font-size: 11px !important;
           }
           
           .trading-panel {
               margin: 0 !important;
               border-radius: 0 !important;
           }
           
           .panel-header {
               padding: 12px 16px !important;
           }
           
           .panel-title {
               font-size: 16px !important;
           }
           
           .panel-subtitle {
               font-size: 11px !important;
           }
           
           .forex-pair-item {
               padding: 10px 12px !important;
               margin-bottom: 8px !important;
           }
           
           .pair-symbol {
               font-size: 13px !important;
           }
           
           .pair-category {
               font-size: 9px !important;
           }
           
           .pair-price {
               font-size: 14px !important;
           }
           
           .pair-spread {
               font-size: 10px !important;
           }
       }

               /* Profile Page Styles */
        .profile-info-card, .balance-card {
            background: linear-gradient(135deg, #1e2530 0%, #2a3441 100%);
            border: 1px solid #2a2f3e;
            border-radius: 12px;
            padding: 24px;
            transition: all 0.3s ease;
        }

        .profile-info-card:hover, .balance-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .stat-card {
            background: linear-gradient(135deg, #1e2530 0%, #2a3441 100%);
            border: 1px solid #2a2f3e;
            border-radius: 12px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #00d4aa 0%, #00a87a 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .stat-content {
            flex: 1;
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #8b8fa3;
            font-size: 0.9rem;
            margin: 0;
        }

        .transaction-history-card {
            background: linear-gradient(135deg, #1e2530 0%, #2a3441 100%);
            border: 1px solid #2a2f3e;
            border-radius: 12px;
            padding: 24px;
        }

        .refresh-btn {
            background: linear-gradient(135deg, #00d4aa 0%, #00a87a 100%);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .refresh-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 5px 15px rgba(0, 212, 170, 0.3);
        }

        .transaction-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            margin-bottom: 10px;
            background: rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
        }

        .transaction-item:hover {
            background: rgba(255, 255, 255, 0.08);
        }

        .transaction-info {
            flex: 1;
        }

        .transaction-type {
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 5px;
        }

        .transaction-details {
            color: #8b8fa3;
            font-size: 0.9rem;
        }

        .transaction-amount {
            font-weight: 700;
            font-size: 1.1rem;
        }

        .transaction-amount.positive {
            color: #00d4aa;
        }

        .transaction-amount.negative {
            color: #ff4757;
        }

        /* Extra Small Mobile Devices */
        @media (max-width: 480px) {
            .main-content {
                width: 100%;
            }
            
            .top-bar {
                padding: 12px 16px;
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .content-area {
                padding: 12px;
            }
            
            .page-title {
                font-size: 20px;
            }
            
            .balance-display {
                padding: 8px 12px;
                font-size: 13px;
            }
            
            .user-avatar {
                width: 36px;
                height: 36px;
                font-size: 14px;
            }
            
            .logout-btn {
                padding: 8px 12px;
                font-size: 13px;
            }
            
            .card {
                padding: 16px;
                margin-bottom: 12px;
            }
            
            .section-title {
                font-size: 24px;
            }
            
            .grid {
                gap: 12px;
            }
            
            .user-profile .user-name {
                font-size: 14px;
            }
            
            .user-profile .user-balance {
                font-size: 12px;
            }
            
            /* Full Screen Mobile Trading Modal */
            .modal-container {
                width: 100%;
                height: 100%;
                border-radius: 0;
                max-height: 100vh;
            }
            
            .modal-header {
                padding: 16px 20px;
            }
            
            .modal-title-section h2 {
                font-size: 18px;
                margin-bottom: 6px;
            }
            
            .modal-coin-info {
                gap: 10px;
            }
            
            .modal-coin-info span {
                font-size: 12px;
            }
            
            #modalCoinPrice {
                font-size: 15px;
            }
            
            .chart-panel {
                min-height: 220px;
            }
            
            .chart-header {
                padding: 10px 16px;
            }
            
            .timeframe-buttons {
                gap: 3px;
            }
            
            .timeframe-btn {
                padding: 5px 6px;
                font-size: 10px;
            }
            
            .order-content {
                padding: 12px;
            }
            
            .order-direction-toggle {
                margin-bottom: 16px;
            }
            
            .direction-btn {
                padding: 10px;
            }
            
            .direction-btn .btn-text {
                font-size: 13px;
            }
            
            .form-group {
                margin-bottom: 12px;
            }
            
            .form-select, .form-input {
                padding: 8px 10px;
                font-size: 12px;
            }
            
            .execute-btn {
                padding: 12px;
                font-size: 14px;
                margin-bottom: 12px;
            }
            
            .content-area {
                padding: 4px !important;
            }
            
            .mobile-coins-grid {
                padding: 4px !important;
                gap: 6px !important;
            }
            
            .mobile-coin-card {
                padding: 16px !important;
                min-height: 110px !important;
            }
            
            .mobile-coin-logo {
                width: 45px !important;
                height: 45px !important;
                font-size: 18px !important;
            }
            
            .mobile-coin-details h3 {
                font-size: 16px !important;
            }
            
            .mobile-coin-price {
                font-size: 18px !important;
            }
            
            .mobile-trade-btn {
                padding: 12px !important;
                font-size: 14px !important;
                min-height: 44px !important;
            }
        }

        /* Landscape Mobile */
        @media (max-width: 768px) and (orientation: landscape) {
            .modal-content {
                grid-template-columns: 1fr 320px;
                grid-template-rows: 1fr;
            }
            
            .chart-panel {
                border-right: 1px solid rgba(255, 255, 255, 0.1);
                border-bottom: none;
                min-height: auto;
            }
            
            .order-panel {
                min-height: auto;
                max-height: none;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Mobile Overlay -->
        <div class="mobile-overlay" onclick="closeMobileMenu()"></div>
        
        <!-- Sol Navigasyon Paneli -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-chart-line"></i>
                    <span>TradePro</span>
                </div>
            </div>
            
            <nav class="nav-menu">
                <div class="nav-item">
                    <a href="#" class="nav-link active" data-section="dashboard">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" data-section="portfolio">
                        <i class="fas fa-briefcase"></i>
                        <span>Portföyüm</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" data-section="markets">
                        <i class="fas fa-coins"></i>
                        <span>Piyasalar</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" data-section="trading">
                        <i class="fas fa-exchange-alt"></i>
                        <span>İşlem Yap</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" data-section="recommendations">
                        <i class="fas fa-lightbulb"></i>
                        <span>Tavsiyeler</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" data-section="wallet">
                        <i class="fas fa-wallet"></i>
                        <span>Cüzdan</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" data-section="deposit">
                        <i class="fas fa-plus-circle"></i>
                        <span>Para Yatır</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" data-section="profile">
                        <i class="fas fa-user"></i>
                        <span>Profil</span>
                    </a>
                </div>
            </nav>
        </aside>
        
        <!-- Ana İçerik Alanı -->
        <main class="main-content">
            <!-- Üst Bar -->
            <header class="top-bar">
                <div class="top-bar-left">
                    <button class="mobile-menu-btn" onclick="toggleMobileMenu()">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h1 class="page-title" id="pageTitle">Dashboard</h1>
                </div>
                <div class="top-bar-right">
                    <div class="balance-display" id="userBalance">
                        <i class="fas fa-spinner fa-spin"></i> Yükleniyor...
                    </div>
                    <div class="user-menu">
                        <div class="user-avatar" id="userAvatar">?</div>
                    </div>
                    <button class="logout-btn" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> Çıkış
                    </button>
                </div>
            </header>
            
            <!-- İçerik Alanları -->
            <div class="content-area">
                
                <!-- Dashboard Bölümü -->
                <section class="content-section active" id="dashboard">
                    <div class="section-header">
                        <h2 class="section-title">Hoş Geldiniz</h2>
                        <p class="section-subtitle">Trading hesabınızın genel durumu</p>
                    </div>
                    
                    <div class="grid grid-3">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Toplam Bakiye</h3>
                                <i class="fas fa-wallet" style="color: #00d4aa;"></i>
                            </div>
                            <div id="totalBalance" class="loading">
                                <div class="spinner"></div>
                                Yükleniyor...
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Günlük Kazanç</h3>
                                <i class="fas fa-chart-line" style="color: #00d4aa;"></i>
                            </div>
                            <div id="dailyPnl" class="loading">
                                <div class="spinner"></div>
                                Hesaplanıyor...
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Açık Pozisyonlar</h3>
                                <i class="fas fa-chart-pie" style="color: #00d4aa;"></i>
                            </div>
                            <div id="openPositions" class="loading">
                                <div class="spinner"></div>
                                Yükleniyor...
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-2">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Son İşlemler</h3>
                            </div>
                            <div id="recentTrades" class="loading">
                                <div class="spinner"></div>
                                Yükleniyor...
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Piyasa Özetı</h3>
                            </div>
                            <div id="marketSummary" class="loading">
                                <div class="spinner"></div>
                                Yükleniyor...
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- Diğer bölümler buraya eklenecek -->
                <section class="content-section" id="portfolio">
                    <div class="section-header">
                        <h2 class="section-title">Portföyüm</h2>
                        <p class="section-subtitle">Sahip olduğunuz kripto varlıklar ve performansları</p>
                    </div>
                    
                    <!-- Portföy Özeti -->
                    <div class="grid grid-4">
                        <div class="card stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-wallet" style="color: #00d4aa;"></i>
                            </div>
                            <div class="stat-content">
                                <h4 class="stat-value" id="portfolioTotalValue">₺0</h4>
                                <p class="stat-label">Toplam Portföy Değeri</p>
                            </div>
                        </div>
                        
                        <div class="card stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-chart-line" style="color: #ffa726;"></i>
                            </div>
                            <div class="stat-content">
                                <h4 class="stat-value" id="portfolioProfitLoss">₺0</h4>
                                <p class="stat-label">Toplam Kar/Zarar</p>
                            </div>
                        </div>
                        
                        <div class="card stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-percentage" style="color: #42a5f5;"></i>
                            </div>
                            <div class="stat-content">
                                <h4 class="stat-value" id="portfolioProfitPercent">0%</h4>
                                <p class="stat-label">Kar/Zarar Oranı</p>
                            </div>
                        </div>
                        
                        <div class="card stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-coins" style="color: #ab47bc;"></i>
                            </div>
                            <div class="stat-content">
                                <h4 class="stat-value" id="portfolioCoinCount">0</h4>
                                <p class="stat-label">Coin Sayısı</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Portföy Listesi -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">
                                <i class="fas fa-list" style="color: #00d4aa;"></i>
                                Varlık Listesi
                            </h3>
                            <button class="btn-secondary" onclick="loadPortfolio()" style="padding: 8px 16px;">
                                <i class="fas fa-refresh"></i> Yenile
                            </button>
                        </div>
                        
                        <!-- Loading State -->
                        <div id="portfolioLoader" class="loading" style="display: none; text-align: center; padding: 40px;">
                            <div class="spinner"></div>
                            <p>Portföy yükleniyor...</p>
                        </div>
                        
                        <!-- Empty State -->
                        <div id="portfolioEmpty" style="display: none; text-align: center; padding: 60px 20px; color: #8b8fa3;">
                            <i class="fas fa-inbox" style="font-size: 48px; margin-bottom: 16px; opacity: 0.5;"></i>
                            <h3 style="color: #ffffff; margin-bottom: 12px;">Portföyünüz Boş</h3>
                            <p style="margin-bottom: 24px;">Henüz hiç coin satın almamışsınız. Piyasalar sayfasından coin alım-satımı yapabilirsiniz.</p>
                            <button onclick="showSection('markets')" style="background: #00d4aa; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer;">
                                <i class="fas fa-shopping-cart"></i> Coin Satın Al
                            </button>
                        </div>
                        
                        <!-- Portfolio Table -->
                        <div id="portfolioTable" style="display: none;">
                            <div class="table-responsive">
                                <table class="modern-table">
                                    <thead>
                                        <tr>
                                            <th>Varlık</th>
                                            <th>Miktar</th>
                                            <th>Ortalama Fiyat</th>
                                            <th>Güncel Fiyat</th>
                                            <th>Değer</th>
                                            <th>Kar/Zarar</th>
                                            <th>%</th>
                                            <th>İşlemler</th>
                                        </tr>
                                    </thead>
                                    <tbody id="portfolioTableBody">
                                        <!-- Portfolio items will be inserted here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Para Yatırma Bölümü -->
                <section class="content-section" id="deposit">
                    <div class="section-header">
                        <h2 class="section-title">Para Yatır</h2>
                        <p class="section-subtitle">Hesabınıza para yatırarak işlem yapmaya başlayın</p>
                    </div>

                    <div class="grid grid-2">
                        <!-- Deposit Form -->
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">
                                    <i class="fas fa-plus-circle" style="color: #00d4aa;"></i>
                                    Para Yatırma Formu
                                </h3>
                            </div>
                            
                            <form id="deposit-form" style="display: flex; flex-direction: column; gap: 20px;">
                                <div class="form-group">
                                    <label for="deposit-method" style="display: block; margin-bottom: 8px; font-weight: 600; color: #ffffff;">Yatırma Yöntemi:</label>
                                    <select id="deposit-method" style="width: 100%; padding: 12px 16px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: #ffffff; font-size: 14px;" required>
                                        <option value="">Yöntem seçiniz</option>
                                        <option value="papara">Papara</option>
                                        <option value="kredi_karti">Kredi Kartı</option>
                                        <option value="havale">Banka Havalesi</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="deposit-amount" style="display: block; margin-bottom: 8px; font-weight: 600; color: #ffffff;">Yatırılacak Tutar (₺):</label>
                                    <input type="number" id="deposit-amount" placeholder="1000" min="10" max="50000" step="0.01" style="width: 100%; padding: 12px 16px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: #ffffff; font-size: 14px;" required>
                                    <small style="color: #8b8fa3; font-size: 12px; margin-top: 4px; display: block;">Minimum: ₺10 - Maksimum: ₺50,000</small>
                                </div>

                                <!-- Papara specific fields -->
                                <div id="papara-fields" class="method-fields" style="display: none;">
                                    <div class="form-group">
                                        <label for="papara-number" style="display: block; margin-bottom: 8px; font-weight: 600; color: #ffffff;">Papara Numarası:</label>
                                        <input type="text" id="papara-number" placeholder="Papara numaranızı girin" style="width: 100%; padding: 12px 16px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: #ffffff; font-size: 14px;">
                                    </div>
                                </div>

                                <!-- Credit Card specific fields -->
                                <div id="kredi_karti-fields" class="method-fields" style="display: none;">
                                    <div class="form-group">
                                        <label for="card-number" style="display: block; margin-bottom: 8px; font-weight: 600; color: #ffffff;">Kart Numarası:</label>
                                        <input type="text" id="card-number" placeholder="1234 5678 9012 3456" maxlength="19" style="width: 100%; padding: 12px 16px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: #ffffff; font-size: 14px;">
                                    </div>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                        <div class="form-group">
                                            <label for="card-expiry" style="display: block; margin-bottom: 8px; font-weight: 600; color: #ffffff;">Son Kullanma:</label>
                                            <input type="text" id="card-expiry" placeholder="MM/YY" maxlength="5" style="width: 100%; padding: 12px 16px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: #ffffff; font-size: 14px;">
                                        </div>
                                        <div class="form-group">
                                            <label for="card-cvv" style="display: block; margin-bottom: 8px; font-weight: 600; color: #ffffff;">CVV:</label>
                                            <input type="text" id="card-cvv" placeholder="123" maxlength="3" style="width: 100%; padding: 12px 16px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: #ffffff; font-size: 14px;">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="card-holder" style="display: block; margin-bottom: 8px; font-weight: 600; color: #ffffff;">Kart Sahibi:</label>
                                        <input type="text" id="card-holder" placeholder="JOHN DOE" style="width: 100%; padding: 12px 16px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: #ffffff; font-size: 14px; text-transform: uppercase;">
                                    </div>
                                </div>

                                <!-- Bank Transfer specific fields -->
                                <div id="havale-fields" class="method-fields" style="display: none;">
                                    <div class="form-group">
                                        <label for="sender-name" style="display: block; margin-bottom: 8px; font-weight: 600; color: #ffffff;">Gönderen Adı:</label>
                                        <input type="text" id="sender-name" placeholder="Adınız ve soyadınız" style="width: 100%; padding: 12px 16px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: #ffffff; font-size: 14px;">
                                    </div>
                                    <div class="form-group">
                                        <label for="sender-iban" style="display: block; margin-bottom: 8px; font-weight: 600; color: #ffffff;">Gönderen IBAN:</label>
                                        <input type="text" id="sender-iban" placeholder="TR63 0006 4000 0019 3001 9751 44" style="width: 100%; padding: 12px 16px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: #ffffff; font-size: 14px;">
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="deposit-note" style="display: block; margin-bottom: 8px; font-weight: 600; color: #ffffff;">Not (İsteğe bağlı):</label>
                                    <textarea id="deposit-note" rows="3" placeholder="İlave notunuz varsa buraya yazabilirsiniz..." style="width: 100%; padding: 12px 16px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: #ffffff; font-size: 14px; resize: vertical;"></textarea>
                                </div>

                                <button type="submit" style="width: 100%; padding: 16px; background: linear-gradient(135deg, #00d4aa 0%, #00b894 100%); color: white; border: none; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 20px rgba(0, 212, 170, 0.3);">
                                    <i class="fas fa-paper-plane"></i> Para Yatırma Talebi Gönder
                                </button>
                            </form>
                        </div>

                        <!-- Deposit Information -->
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">
                                    <i class="fas fa-info-circle" style="color: #3b82f6;"></i>
                                    Para Yatırma Bilgileri
                                </h3>
                            </div>
                            
                            <div style="color: #e2e8f0; line-height: 1.6;">
                                <div style="margin-bottom: 20px; padding: 16px; background: rgba(0, 212, 170, 0.1); border-left: 4px solid #00d4aa; border-radius: 8px;">
                                    <h4 style="color: #00d4aa; margin-bottom: 8px;">
                                        <i class="fas fa-clock"></i> İşlem Süreleri
                                    </h4>
                                    <ul style="margin: 0; padding-left: 20px;">
                                        <li><strong>Papara:</strong> Anında</li>
                                        <li><strong>Kredi Kartı:</strong> 5-15 dakika</li>
                                        <li><strong>Banka Havalesi:</strong> 1-2 iş günü</li>
                                    </ul>
                                </div>

                                <div style="margin-bottom: 20px; padding: 16px; background: rgba(59, 130, 246, 0.1); border-left: 4px solid #3b82f6; border-radius: 8px;">
                                    <h4 style="color: #3b82f6; margin-bottom: 8px;">
                                        <i class="fas fa-shield-alt"></i> Güvenlik
                                    </h4>
                                    <p>Tüm işlemleriniz SSL şifreleme ile korunmaktadır. Kart bilgileriniz güvenli bir şekilde saklanır.</p>
                                </div>

                                <div style="margin-bottom: 20px;">
                                    <h4 style="color: #ffffff; margin-bottom: 12px;">
                                        <i class="fas fa-university"></i> Banka Hesap Bilgileri
                                    </h4>
                                    <div style="background: rgba(255, 255, 255, 0.05); padding: 16px; border-radius: 8px; font-family: monospace;">
                                        <p><strong>Banka:</strong> Ziraat Bankası</p>
                                        <p><strong>IBAN:</strong> TR63 0006 4000 0019 3001 9751 44</p>
                                        <p><strong>Hesap Sahibi:</strong> TradePro Ltd.</p>
                                        <p style="color: #fbbf24; font-size: 12px; margin-top: 12px;">
                                            <i class="fas fa-exclamation-triangle"></i>
                                            Havale yaparken açıklama kısmına kullanıcı adınızı yazınız.
                                        </p>
                                    </div>
                                </div>

                                <div style="padding: 16px; background: rgba(239, 68, 68, 0.1); border-left: 4px solid #ef4444; border-radius: 8px;">
                                    <h4 style="color: #ef4444; margin-bottom: 8px;">
                                        <i class="fas fa-exclamation-circle"></i> Önemli Uyarılar
                                    </h4>
                                    <ul style="margin: 0; padding-left: 20px; font-size: 14px;">
                                        <li>Minimum yatırım tutarı ₺10'dur</li>
                                        <li>Günlük maksimum yatırım limiti ₺50,000'dir</li>
                                        <li>Para yatırma talepleri admin onayı sonrası hesabınıza yansır</li>
                                        <li>Sahte bilgi verenlerin hesapları kapatılabilir</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Deposit Requests -->
                    <div class="card" style="margin-top: 24px;">
                        <div class="card-header">
                            <h3 class="card-title">
                                <i class="fas fa-history" style="color: #8b5cf6;"></i>
                                Son Para Yatırma Talepleriniz
                            </h3>
                        </div>
                        <div id="recent-deposits">
                            <div class="loading">
                                <div class="spinner"></div>
                                Talepler yükleniyor...
                            </div>
                        </div>
                    </div>
                </section>
                
                <section class="content-section" id="markets">
                    <div class="section-header">
                        <h2 class="section-title">Piyasalar</h2>
                        <p class="section-subtitle">Anlık kripto para fiyatları ve piyasa analizi</p>
                    </div>
                    
                    <div class="modern-market-container">
                        <div class="market-header">
                            <div class="market-title-section">
                                <h3 class="market-title">
                                    <i class="fas fa-chart-line"></i>
                                    Kripto Para Piyasası
                                </h3>
                                <p class="market-subtitle">Gerçek zamanlı veriler • Güncellenme: <span id="lastUpdate">Şimdi</span></p>
                            </div>
                            <div class="market-controls">
                                <div class="search-container">
                                    <i class="fas fa-search"></i>
                                    <input type="text" id="coinSearch" placeholder="Coin ara...">
                                </div>
                                <button class="refresh-btn" onclick="refreshMarketData()">
                                    <i class="fas fa-sync-alt"></i>
                                    <span>Yenile</span>
                                </button>
                            </div>
                        </div>
                        
                        <div class="market-filters">
                            <button class="filter-chip active" data-filter="all">
                                <i class="fas fa-star"></i> Tümü
                            </button>
                            <button class="filter-chip" data-filter="favorites">
                                <i class="fas fa-heart"></i> Favoriler
                            </button>
                            <button class="filter-chip" data-filter="trending">
                                <i class="fas fa-fire"></i> Trend
                            </button>
                            <button class="filter-chip" data-filter="top">
                                <i class="fas fa-trophy"></i> Top 10
                            </button>
                        </div>
                        
                        <div id="marketLoader" class="modern-loading">
                            <div class="loading-animation">
                                <div class="loading-dot"></div>
                                <div class="loading-dot"></div>
                                <div class="loading-dot"></div>
                            </div>
                            <p>Piyasa verileri yükleniyor...</p>
                        </div>
                        
                        <!-- Desktop Coins Grid -->
                        <div id="desktopCoinsGrid" class="desktop-coins-grid" style="display: none;">
                            <!-- Coin kartları buraya yüklenecek -->
                        </div>
                        
                        <!-- Mobile Coins Grid -->
                        <div id="mobileCoinsGrid" class="mobile-coins-grid" style="display: none;">
                            <!-- Mobil coin kartları buraya yüklenecek -->
                        </div>
                        
                        <!-- Legacy table (gizli) -->
                        <div id="marketTable" style="display: none;">
                            <div style="overflow-x: auto;">
                                <table style="width: 100%; border-collapse: collapse;">
                                    <thead>
                                        <tr style="border-bottom: 1px solid #2a2f3e;">
                                            <th style="padding: 12px; text-align: left; color: #8b8fa3; font-weight: 600;">#</th>
                                            <th style="padding: 12px; text-align: left; color: #8b8fa3; font-weight: 600;">Coin</th>
                                            <th style="padding: 12px; text-align: right; color: #8b8fa3; font-weight: 600;">Fiyat</th>
                                            <th style="padding: 12px; text-align: right; color: #8b8fa3; font-weight: 600;">24s %</th>
                                            <th style="padding: 12px; text-align: right; color: #8b8fa3; font-weight: 600;">Piyasa Değeri</th>
                                            <th style="padding: 12px; text-align: center; color: #8b8fa3; font-weight: 600;">İşlem</th>
                                        </tr>
                                    </thead>
                                    <tbody id="marketTableBody">
                                        <!-- Coin verileri buraya yüklenecek -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>
                
                <section class="content-section" id="trading">
                    <div class="trading-container">
                        <div class="trading-header">
                            <h2 class="trading-title">Professional Trading</h2>
                            <p class="trading-subtitle">Advanced Forex, Indices & Commodities Platform</p>
                            
                            <div class="trading-filters">
                                <button class="filter-btn active" data-category="all">All Markets</button>
                                <button class="filter-btn" data-category="major">Major Pairs</button>
                                <button class="filter-btn" data-category="minor">Minor Pairs</button>
                                <button class="filter-btn" data-category="indices">Indices</button>
                                <button class="filter-btn" data-category="commodities">Commodities</button>
                            </div>
                        </div>
                        
                        <!-- Trading Workspace -->
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0; height: 600px;">
                            <!-- Sol Panel: Market Watch -->
                            <div class="trading-panel" style="border-radius: 0; margin: 0; border-right: 1px solid rgba(255, 255, 255, 0.1);">
                                <div class="panel-header">
                                    <h3 class="panel-title">Market Watch</h3>
                                    <p class="panel-subtitle">Real-time quotes and spreads</p>
                                </div>
                                
                                <div id="forexPairsContainer" style="height: 480px; overflow-y: auto;">
                                    <div class="loading" id="forexLoader" style="margin: 60px 0;">
                                        <div class="spinner"></div>
                                        Loading market data...
                                    </div>
                                    <div id="forexPairsList" style="display: none;"></div>
                                </div>
                            </div>
                            
                            <!-- Sağ Panel: Trading Terminal -->
                            <div class="trading-panel" style="border-radius: 0; margin: 0;">
                                <div class="panel-header">
                                    <h3 class="panel-title">Trading Terminal</h3>
                                    <div id="selectedPairInfo" class="panel-subtitle">
                                        Select an instrument to start trading
                                    </div>
                                </div>
                                
                                <div style="padding: 24px; height: 480px; overflow-y: auto;">
                                    <div id="tradingForm" style="display: none;">
                                        <!-- Direction Selection -->
                                        <div class="trade-direction-container">
                                            <button class="trade-direction-btn active" id="longBtn" data-direction="long">
                                                <i class="fas fa-arrow-up"></i>
                                                <div style="margin-top: 4px;">BUY / LONG</div>
                                            </button>
                                            <button class="trade-direction-btn" id="shortBtn" data-direction="short">
                                                <i class="fas fa-arrow-down"></i>
                                                <div style="margin-top: 4px;">SELL / SHORT</div>
                                            </button>
                                        </div>
                                        
                                        <!-- Trading Parameters -->
                                        <div class="trading-form-group">
                                            <label class="trading-label">Volume (Lots)</label>
                                            <select id="lotSize" class="trading-select">
                                                <option value="0.01">0.01 (Micro Lot)</option>
                                                <option value="0.1">0.1 (Mini Lot)</option>
                                                <option value="1.0">1.0 (Standard Lot)</option>
                                                <option value="5.0">5.0 (Large Lot)</option>
                                                <option value="10.0">10.0 (Institutional)</option>
                                            </select>
                                        </div>
                                        
                                        <div class="trading-form-group">
                                            <label class="trading-label">Leverage Ratio</label>
                                            <select id="leverageRatio" class="trading-select">
                                                <option value="10">1:10 (Conservative)</option>
                                                <option value="50">1:50 (Moderate)</option>
                                                <option value="100" selected>1:100 (Standard)</option>
                                                <option value="200">1:200 (Aggressive)</option>
                                                <option value="500">1:500 (Professional)</option>
                                            </select>
                                        </div>
                                        
                                        <!-- Risk Management -->
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                                            <div class="trading-form-group">
                                                <label class="trading-label">Stop Loss</label>
                                                <input type="number" id="stopLoss" class="trading-input" placeholder="0.00000" step="0.00001">
                                            </div>
                                            <div class="trading-form-group">
                                                <label class="trading-label">Take Profit</label>
                                                <input type="number" id="takeProfit" class="trading-input" placeholder="0.00000" step="0.00001">
                                            </div>
                                        </div>
                                        
                                        <!-- Trade Calculation -->
                                        <div class="trade-calculation-panel">
                                            <div class="calculation-row">
                                                <span class="calculation-label">Required Margin</span>
                                                <span class="calculation-value" id="requiredMargin">$0.00</span>
                                            </div>
                                            <div class="calculation-row">
                                                <span class="calculation-label">Pip Value</span>
                                                <span class="calculation-value" id="pipValue">$0.00</span>
                                            </div>
                                            <div class="calculation-row">
                                                <span class="calculation-label">Spread</span>
                                                <span class="calculation-value negative" id="spreadValue">0.0 pips</span>
                                            </div>
                                            <div class="calculation-row">
                                                <span class="calculation-label">Contract Size</span>
                                                <span class="calculation-value" id="contractSize">100,000</span>
                                            </div>
                                        </div>
                                        
                                                                        <!-- Execute Button -->
                                <button class="trade-btn-modern buy" style="margin-top: 24px;">
                                    <i class="fas fa-bolt"></i>
                                    <span>İŞLEMİ GERÇEKLEŞTİR</span>
                                </button>
                                    </div>
                                    
                                    <!-- No Selection State -->
                                    <div id="noSelectionMessage" class="no-selection-message">
                                        <div class="no-selection-icon">
                                            <i class="fas fa-chart-line"></i>
                                        </div>
                                        <h3 style="margin-bottom: 12px; color: #ffffff;">Ready to Trade</h3>
                                        <p>Select an instrument from Market Watch to begin professional trading</p>
                                        <div style="margin-top: 24px; font-size: 12px; color: #8896ab;">
                                            <div>✓ Advanced risk management</div>
                                            <div>✓ Real-time execution</div>
                                            <div>✓ Professional tools</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Open Positions Panel -->
                    <div class="trading-container" style="margin-top: 24px;">
                        <div class="trading-header">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <h3 class="trading-title" style="font-size: 18px; margin-bottom: 4px;">Open Positions</h3>
                                    <p class="trading-subtitle">Active trades and P&L monitoring</p>
                                </div>
                                <button onclick="refreshPositions()" style="padding: 10px 16px; background: linear-gradient(135deg, #4fc3f7 0%, #29b6f6 100%); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">
                                    <i class="fas fa-sync-alt"></i> Refresh
                                </button>
                            </div>
                        </div>
                        
                        <div style="padding: 24px;">
                            <div id="openPositionsContainer">
                                <div class="loading" id="positionsLoader" style="margin: 40px 0;">
                                    <div class="spinner"></div>
                                    Loading positions...
                                </div>
                                <div id="openPositionsList" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Trading Modal -->
                <div id="tradingModal" class="modern-trading-modal" style="display: none;">
                    <div class="modal-overlay" onclick="closeTradingModal()"></div>
                    <div class="modal-container">
                        <!-- Modern Header -->
                        <div class="modal-header-modern">
                            <div class="header-left">
                                <div class="coin-basic-info">
                                    <div class="coin-icon">
                                        <i class="fab fa-bitcoin"></i>
                                    </div>
                                    <div class="coin-text">
                                        <h3 id="modalCoinName">Bitcoin</h3>
                                        <span id="modalCoinSymbol">BTC</span>
                                    </div>
                                </div>
                                <div class="price-display">
                                    <div class="current-price-modern" id="modalCoinPrice">$45,230.50</div>
                                    <div class="price-change-modern positive" id="modalCoinChange">+2.45%</div>
                                </div>
                            </div>
                            <div class="header-right">
                                <button class="close-btn-modern" onclick="closeTradingModal()">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Modern Content -->
                        <div class="modal-content-modern">
                            <!-- Chart Section -->
                            <div class="chart-section-modern">
                                <div class="chart-header">
                                    <h4>Fiyat Grafiği</h4>
                                    <div class="time-filters">
                                        <button class="time-btn active">1H</button>
                                        <button class="time-btn">4H</button>
                                        <button class="time-btn">1D</button>
                                        <button class="time-btn">1W</button>
                                    </div>
                                </div>
                                <div class="chart-container-modern" style="
                                    width: 100% !important;
                                    height: 300px !important;
                                    background: rgba(255, 255, 255, 0.03) !important;
                                    border: 1px solid rgba(255, 255, 255, 0.1) !important;
                                    border-radius: 12px !important;
                                    position: relative !important;
                                    margin-bottom: 20px !important;
                                    padding: 12px !important;
                                ">
                                    <canvas id="tradingChart" style="
                                        width: 100% !important;
                                        height: 100% !important;
                                        display: block !important;
                                    "></canvas>
                                    <div style="
                                        position: absolute !important;
                                        top: 10px !important;
                                        left: 10px !important;
                                        color: #00ff00 !important;
                                        font-size: 12px !important;
                                        z-index: 1000 !important;
                                        background: rgba(0, 0, 0, 0.8) !important;
                                        padding: 6px 8px !important;
                                        border-radius: 4px !important;
                                    ">
                                        🔥 TEST CHART
                                    </div>
                                </div>
                                <div class="chart-stats">
                                    <div class="stat-modern">
                                        <span class="stat-label">24H Yüksek</span>
                                        <span class="stat-value positive" id="modalCoinHigh">$46,890</span>
                                    </div>
                                    <div class="stat-modern">
                                        <span class="stat-label">24H Düşük</span>
                                        <span class="stat-value negative" id="modalCoinLow">$44,120</span>
                                    </div>
                                    <div class="stat-modern">
                                        <span class="stat-label">Hacim</span>
                                        <span class="stat-value">$2.4B</span>
                                    </div>
                                </div>
                            </div>
                                
                            <!-- Trading Form -->
                            <div class="trading-form-modern">
                                <div class="form-header">
                                    <h4>İşlem Yap</h4>
                                    <div class="trade-type-toggle">
                                        <button class="trade-type-btn active">Spot</button>
                                        <button class="trade-type-btn">Kaldıraçlı</button>
                                    </div>
                                </div>
                                
                                <!-- Buy/Sell Toggle -->
                                <div class="buy-sell-toggle">
                                    <button class="trade-btn-modern buy active">
                                        <i class="fas fa-arrow-up"></i>
                                        <span>ALIŞ</span>
                                        <small id="buyPrice">₺1,350,000</small>
                                    </button>
                                    <button class="trade-btn-modern sell">
                                        <i class="fas fa-arrow-down"></i>
                                        <span>SATIŞ</span>
                                        <small id="sellPrice">₺1,348,000</small>
                                    </button>
                                </div>
                                    
                                <!-- Form Fields -->
                                <div class="form-row">
                                    <div class="form-group-modern">
                                        <label>İşlem Türü</label>
                                        <select class="form-input-modern">
                                            <option>Piyasa Emri</option>
                                            <option>Limit Emri</option>
                                            <option>Stop-Limit</option>
                                        </select>
                                    </div>
                                    <div class="form-group-modern">
                                        <label>Miktar</label>
                                        <input type="number" class="form-input-modern" placeholder="0.00" step="0.01">
                                    </div>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group-modern">
                                        <label>Fiyat (₺)</label>
                                        <input type="number" class="form-input-modern" placeholder="0.00" step="0.01">
                                    </div>
                                    <div class="form-group-modern">
                                        <label>Toplam</label>
                                        <input type="number" class="form-input-modern" placeholder="0.00" step="0.01" readonly>
                                    </div>
                                </div>
                                    
                                    <!-- Birim Girişi -->
                                    <div class="form-group" id="quantityGroup">
                                        <div class="input-group">
                                            <input type="number" id="orderQuantity" class="form-input" placeholder="0.00" step="0.00001">
                                            <span class="input-suffix" id="quantitySuffix">BTC</span>
                                        </div>
                                        <div class="percentage-buttons">
                                            <button class="percent-btn" data-percent="25">%25</button>
                                            <button class="percent-btn" data-percent="50">%50</button>
                                            <button class="percent-btn" data-percent="75">%75</button>
                                            <button class="percent-btn" data-percent="100">%100</button>
                                        </div>
                                    </div>
                                    
                                    <!-- Tutar Girişi -->
                                    <div class="form-group" id="totalGroup" style="display: none;">
                                        <div class="input-group">
                                            <input type="number" id="orderTotal" class="form-input" placeholder="0.00" step="0.01">
                                            <span class="input-suffix">₺</span>
                                        </div>
                                    </div>
                                    
                                    <!-- İşlem Özeti -->
                                    <div class="order-summary">
                                        <div class="summary-row">
                                            <span class="summary-label">Mevcut Bakiye:</span>
                                            <span class="summary-value" id="availableBalance">₺10,000.00</span>
                                        </div>
                                        <div class="summary-row">
                                            <span class="summary-label">İşlem Tutarı:</span>
                                            <span class="summary-value" id="orderTotalValue">₺0.00</span>
                                        </div>
                                        <div class="summary-row">
                                            <span class="summary-label">Komisyon (%0.1):</span>
                                            <span class="summary-value" id="tradingFee">₺0.00</span>
                                        </div>
                                    </div>
                                    
                                    <!-- İşlem Onayı Butonu -->
                                    <button id="executeOrderBtn" class="execute-btn buy-order" disabled>
                                        <i class="fas fa-bolt"></i>
                                        <span id="executeText">BTC Al</span>
                                    </button>
                                    
                                    <!-- Gelişmiş Seçenekler -->
                                    <div class="advanced-options">
                                        <button class="advanced-toggle" onclick="toggleAdvancedOptions()">
                                            <i class="fas fa-chevron-down"></i>
                                            Gelişmiş Seçenekler
                                        </button>
                                        <div class="advanced-content" id="advancedContent" style="display: none;">
                                            <div class="form-group">
                                                <label class="form-label">Stop Loss</label>
                                                <input type="number" id="stopLoss" class="form-input" placeholder="İsteğe bağlı" step="0.01">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Take Profit</label>
                                                <input type="number" id="takeProfit" class="form-input" placeholder="İsteğe bağlı" step="0.01">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <section class="content-section" id="recommendations">
                    <div class="section-header">
                        <h2 class="section-title">Yatırım Tavsiyeleri</h2>
                        <p class="section-subtitle">AI destekli öneriler</p>
                    </div>
                    <div class="card">
                        <p>Tavsiye sistemi yakında eklenecek...</p>
                    </div>
                </section>
                
                <section class="content-section" id="wallet">
                    <div class="section-header">
                        <h2 class="section-title">Cüzdan</h2>
                        <p class="section-subtitle">Para yatır/çek</p>
                    </div>
                    <div class="card">
                        <p>Cüzdan işlemleri yakında eklenecek...</p>
                    </div>
                </section>
                
                <section class="content-section" id="profile">
                    <div class="section-header">
                        <h2 class="section-title">Profil</h2>
                        <p class="section-subtitle">Hesap bilgileri ve işlem geçmişi</p>
                    </div>
                    
                    <div class="grid grid-2">
                        <!-- Kullanıcı Bilgileri Kartı -->
                        <div class="card profile-info-card">
                            <div class="card-header">
                                <h3 class="card-title">
                                    <i class="fas fa-user" style="color: #00d4aa; margin-right: 10px;"></i>
                                    Kullanıcı Bilgileri
                                </h3>
                            </div>
                            <div id="userInfo" class="loading">
                                <div class="spinner"></div>
                                Yükleniyor...
                            </div>
                        </div>
                        
                        <!-- Bakiye Kartı -->
                        <div class="card balance-card">
                            <div class="card-header">
                                <h3 class="card-title">
                                    <i class="fas fa-wallet" style="color: #00d4aa; margin-right: 10px;"></i>
                                    Hesap Bakiyesi
                                </h3>
                            </div>
                            <div id="balanceInfo" class="loading">
                                <div class="spinner"></div>
                                Yükleniyor...
                            </div>
                        </div>
                    </div>
                    
                    <!-- Hesap İstatistikleri -->
                    <div class="grid grid-3">
                        <div class="card stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="stat-content">
                                <h4 class="stat-value" id="totalTrades">0</h4>
                                <p class="stat-label">Toplam İşlem</p>
                            </div>
                        </div>
                        
                        <div class="card stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-trophy"></i>
                            </div>
                            <div class="stat-content">
                                <h4 class="stat-value" id="profitLoss">₺0</h4>
                                <p class="stat-label">Toplam Kar/Zarar</p>
                            </div>
                        </div>
                        
                        <div class="card stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-calendar"></i>
                            </div>
                            <div class="stat-content">
                                <h4 class="stat-value" id="memberSince">-</h4>
                                <p class="stat-label">Üyelik Süresi</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- İşlem Geçmişi -->
                    <div class="card transaction-history-card">
                        <div class="card-header">
                            <h3 class="card-title">
                                <i class="fas fa-history" style="color: #00d4aa; margin-right: 10px;"></i>
                                İşlem Geçmişi
                            </h3>
                            <button class="refresh-btn" onclick="loadTransactionHistory()">
                                <i class="fas fa-sync-alt"></i>
                                Yenile
                            </button>
                        </div>
                        <div id="transactionHistory" class="loading">
                            <div class="spinner"></div>
                            İşlem geçmişi yükleniyor...
                        </div>
                    </div>
                </section>
                
            </div>
        </main>
    </div>

    <script>
        // Sayfa yüklendiğinde
        document.addEventListener('DOMContentLoaded', function() {
            loadUserInfo();
            setupNavigation();
            setupDepositForm(); // Para yatırma formunu başlat
            refreshMarketData(); // Sayfa yüklendiğinde piyasaları yükle
            initTrading(); // Trading sistemini başlat
            refreshPositions(); // Pozisyonları yükle
            
            // Arama kutusu için event listener
            const searchInput = document.getElementById('coinSearch');
            let searchTimeout;
            searchInput.addEventListener('input', function() {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => {
                    refreshMarketData();
                }, 500); // 500ms gecikme ile arama yap
            });
        });

        // Navigasyon sistemi
        function setupNavigation() {
            const navLinks = document.querySelectorAll('.nav-link');
            const sections = document.querySelectorAll('.content-section');
            const pageTitle = document.getElementById('pageTitle');
            
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    const targetSection = this.dataset.section;
                    
                    // Aktif nav linkini güncelle
                    navLinks.forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Bölümleri gizle/göster
                    sections.forEach(section => {
                        section.classList.remove('active');
                    });
                    document.getElementById(targetSection).classList.add('active');
                    
                    // Sayfa başlığını güncelle
                    const titles = {
                        'dashboard': 'Dashboard',
                        'portfolio': 'Portföyüm',
                        'markets': 'Piyasalar',
                        'trading': 'İşlem Yap',
                        'recommendations': 'Yatırım Tavsiyeleri',
                        'wallet': 'Cüzdan',
                        'deposit': 'Para Yatır',
                        'profile': 'Profil'
                    };
                    pageTitle.textContent = titles[targetSection] || 'Dashboard';
                    
                    // Section-specific loading
                    if (targetSection === 'deposit') {
                        loadRecentDeposits();
                    } else if (targetSection === 'portfolio') {
                        loadPortfolio();
                    } else if (targetSection === 'profile') {
                        loadTransactionHistory();
                    }
                });
            });
        }

        // Kullanıcı bilgilerini yükle
        function loadUserInfo() {
            fetch('backend/public/profile.php', {
                method: 'GET',
                credentials: 'include'
            })
            .then(r => r.json())
            .then(data => {
                if(data.success) {
                    console.log('✅ Kullanıcı bilgileri yüklendi:', data.user);
                    
                    // Bakiye göster
                    const balance = parseFloat(data.user.balance) || 0;
                    const balanceFormatted = balance.toLocaleString('tr-TR', {
                        minimumFractionDigits: 2,
                        maximumFractionDigits: 2
                    });
                    
                    document.getElementById('userBalance').innerHTML = 
                        `<i class="fas fa-wallet"></i> ₺${balanceFormatted}`;
                    
                    document.getElementById('totalBalance').innerHTML = 
                        `<h1 style="font-size: 2rem; color: #00d4aa;">₺${balanceFormatted}</h1>`;
                    
                    // Avatar harfi
                    const firstLetter = data.user.username.charAt(0).toUpperCase();
                    document.getElementById('userAvatar').textContent = firstLetter;
                    
                    // Profil bilgileri
                    document.getElementById('userInfo').innerHTML = `
                        <div style="line-height: 1.8;">
                            <p><strong>Kullanıcı Adı:</strong> ${data.user.username || 'N/A'}</p>
                            <p><strong>Email:</strong> ${data.user.email || 'N/A'}</p>
                            <p><strong>Ad Soyad:</strong> ${data.user.ad_soyad || 'Belirtilmemiş'}</p>
                            <p><strong>Kayıt Tarihi:</strong> ${data.user.created_at ? new Date(data.user.created_at).toLocaleDateString('tr-TR') : 'N/A'}</p>
                            <p><strong>Son Giriş:</strong> ${data.user.son_giris ? new Date(data.user.son_giris).toLocaleDateString('tr-TR') : 'İlk giriş'}</p>
                            <p><strong>Hesap Tipi:</strong> ${data.user.role === 'admin' ? 'Yönetici' : 'Standart Kullanıcı'}</p>
                            <p><strong>Toplam Bakiye:</strong> <span style="color: #00d4aa; font-weight: 600;">₺${balanceFormatted}</span></p>
                        </div>
                    `;
                    
                    // Bakiye kartı
                    document.getElementById('balanceInfo').innerHTML = `
                        <div style="text-align: center;">
                            <h1 style="font-size: 2.5rem; color: #00d4aa; margin-bottom: 10px;">₺${balanceFormatted}</h1>
                            <p style="color: #8b8fa3; margin-bottom: 15px;">Mevcut Bakiye</p>
                            <div style="display: flex; gap: 10px; justify-content: center;">
                                <button onclick="showSection('deposit')" style="background: #00d4aa; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 14px;">
                                    <i class="fas fa-plus"></i> Para Yatır
                                </button>
                                <button onclick="showSection('withdrawal')" style="background: #2d3748; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 14px;">
                                    <i class="fas fa-minus"></i> Para Çek
                                </button>
                            </div>
                        </div>
                    `;
                    
                    // İstatistikler
                    document.getElementById('totalTrades').textContent = '12';
                    document.getElementById('profitLoss').textContent = '₺2,450';
                    document.getElementById('memberSince').textContent = '3 ay';
                    
                    // İşlem geçmişi ve mevduatları yükle
                    loadTransactionHistory();
                    if (typeof loadRecentDeposits === 'function') {
                        loadRecentDeposits();
                    }
                    
                    // Diğer dashboard verilerini simüle et
                    setTimeout(() => {
                        document.getElementById('dailyPnl').innerHTML = 
                            `<h2 style="color: #00d4aa;">+₺156.24</h2><small style="color: #8b8fa3;">+2.34%</small>`;
                        
                        document.getElementById('openPositions').innerHTML = 
                            `<h2 style="color: #ffffff;">3</h2><small style="color: #8b8fa3;">Aktif pozisyon</small>`;
                        
                        document.getElementById('recentTrades').innerHTML = 
                            `<p style="color: #8b8fa3;">Henüz işlem yapılmamış</p>`;
                        
                        document.getElementById('marketSummary').innerHTML = 
                            `<p style="color: #8b8fa3;">Piyasa verileri yükleniyor...</p>`;
                    }, 1000);
                    
                } else {
                    console.error('❌ Kullanıcı girişi gerekli:', data.message);
                    showNotification('Oturum süreniz dolmuş. Lütfen tekrar giriş yapın.', 'error');
                    setTimeout(() => {
                        window.location.href = 'login.html';
                    }, 2000);
                }
            })
            .catch(err => {
                console.error('❌ API Hatası:', err);
                document.getElementById('totalBalance').innerHTML = '<span style="color: #ef4444;">Bağlantı Hatası</span>';
                document.getElementById('userBalance').innerHTML = '<i class="fas fa-exclamation-triangle"></i> Hata';
                showNotification('Bağlantı hatası. Lütfen sayfayı yenileyin.', 'error');
            });
        }

        // İşlem geçmişi yükle
        async function loadTransactionHistory() {
            const historyContainer = document.getElementById('transactionHistory');
            
            // Loading state göster
            historyContainer.innerHTML = `
                <div class="loading" style="text-align: center; padding: 40px;">
                    <div class="spinner"></div>
                    <p>İşlem geçmişi yükleniyor...</p>
                </div>
            `;
            
            try {
                const response = await fetch('backend/user/transaction_history.php?action=list&limit=20', {
                    method: 'GET',
                    credentials: 'include'
                });
                
                const result = await response.json();
                console.log('✅ Transaction history loaded:', result);
                
                if (result.success && result.data.transactions) {
                    displayTransactionHistory(result.data);
                } else {
                    // Boş durum
                    historyContainer.innerHTML = `
                        <div style="text-align: center; padding: 60px 20px; color: #8b8fa3;">
                            <i class="fas fa-history" style="font-size: 48px; margin-bottom: 16px; opacity: 0.5;"></i>
                            <h3 style="color: #ffffff; margin-bottom: 12px;">Henüz İşlem Yok</h3>
                            <p>Henüz hiç işlem yapmamışsınız. İlk işleminizi yapmak için piyasalar sayfasını ziyaret edin.</p>
                        </div>
                    `;
                }
                
                // İstatistikleri güncelle
                if (result.data.stats) {
                    updateProfileStats(result.data.stats);
                }
                
            } catch (error) {
                console.error('Transaction history loading error:', error);
                historyContainer.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #ef4444;">
                        <i class="fas fa-exclamation-triangle" style="font-size: 24px; margin-bottom: 12px;"></i><br>
                        İşlem geçmişi yüklenirken hata oluştu.<br>
                        <button onclick="loadTransactionHistory()" style="background: #4fc3f7; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; margin-top: 12px;">
                            Tekrar Dene
                        </button>
                    </div>
                `;
            }
        }
        
        // İşlem geçmişini göster
        function displayTransactionHistory(data) {
            const historyContainer = document.getElementById('transactionHistory');
            const transactions = data.transactions;
            
            if (!transactions || transactions.length === 0) {
                historyContainer.innerHTML = `
                    <div style="text-align: center; padding: 60px 20px; color: #8b8fa3;">
                        <i class="fas fa-history" style="font-size: 48px; margin-bottom: 16px; opacity: 0.5;"></i>
                        <h3 style="color: #ffffff; margin-bottom: 12px;">İşlem Geçmişi Boş</h3>
                        <p>Henüz hiç işlem yapmamışsınız.</p>
                    </div>
                `;
                return;
            }
            
            let historyHTML = '';
            transactions.forEach(transaction => {
                const isPositive = parseFloat(transaction.amount) > 0;
                const amount = parseFloat(transaction.amount);
                const formattedAmount = (isPositive ? '+' : '') + '₺' + Math.abs(amount).toLocaleString('tr-TR', { minimumFractionDigits: 2 });
                
                // İşlem tipine göre icon belirle
                let icon = 'fas fa-exchange-alt';
                let iconColor = '#4fc3f7';
                
                if (transaction.type === 'coin_trade') {
                    icon = transaction.sub_type === 'al' ? 'fas fa-arrow-down' : 'fas fa-arrow-up';
                    iconColor = transaction.sub_type === 'al' ? '#00d4aa' : '#ef4444';
                } else if (transaction.type === 'deposit') {
                    icon = 'fas fa-plus-circle';
                    iconColor = '#00d4aa';
                } else if (transaction.type === 'withdrawal') {
                    icon = 'fas fa-minus-circle';
                    iconColor = '#ef4444';
                }
                
                // Status badge
                let statusBadge = '';
                if (transaction.sub_type === 'beklemede') {
                    statusBadge = '<span class="status-badge pending">Beklemede</span>';
                } else if (transaction.sub_type === 'onaylandi' || transaction.sub_type === 'al' || transaction.sub_type === 'sat') {
                    statusBadge = '<span class="status-badge approved">Tamamlandı</span>';
                } else if (transaction.sub_type === 'reddedildi') {
                    statusBadge = '<span class="status-badge rejected">Reddedildi</span>';
                }
                
                historyHTML += `
                    <div class="transaction-item" style="display: flex; align-items: center; justify-content: space-between; padding: 16px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">
                        <div style="display: flex; align-items: center; gap: 16px;">
                            <div style="width: 40px; height: 40px; background: rgba(${iconColor.substring(1, 3)}, ${iconColor.substring(3, 5)}, ${iconColor.substring(5, 7)}, 0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                <i class="${icon}" style="color: ${iconColor}; font-size: 16px;"></i>
                            </div>
                            <div class="transaction-info">
                                <div class="transaction-type" style="font-weight: 600; color: #ffffff; margin-bottom: 4px;">
                                    ${transaction.description}
                                </div>
                                <div class="transaction-details" style="font-size: 12px; color: #8b8fa3;">
                                    ${new Date(transaction.date).toLocaleDateString('tr-TR', { 
                                        year: 'numeric', 
                                        month: 'short', 
                                        day: 'numeric', 
                                        hour: '2-digit', 
                                        minute: '2-digit' 
                                    })}
                                    ${statusBadge}
                                </div>
                            </div>
                        </div>
                        <div class="transaction-amount" style="font-weight: 600; color: ${isPositive ? '#00d4aa' : '#ef4444'};">
                            ${formattedAmount}
                        </div>
                    </div>
                `;
            });
            
            historyContainer.innerHTML = historyHTML;
        }
        
        // Profil istatistiklerini güncelle
        function updateProfileStats(stats) {
            if (stats.total_trades) {
                document.getElementById('totalTrades').textContent = stats.total_trades;
            }
            
            // Kar/zarar hesapla (gelecekte portföy verisi ile)
            const profitLoss = (stats.total_sell_amount || 0) - (stats.total_buy_amount || 0);
            document.getElementById('profitLoss').textContent = `₺${profitLoss.toLocaleString('tr-TR')}`;
            document.getElementById('profitLoss').style.color = profitLoss >= 0 ? '#00d4aa' : '#ef4444';
        }

        // Çıkış yap
        function logout() {
            fetch('backend/public/logout.php', {
                method: 'GET',
                credentials: 'include'
            })
            .then(() => {
                window.location.href = 'login.html';
            });
        }

        // Para yatırma formu fonksiyonları
        function setupDepositForm() {
            const depositForm = document.getElementById('deposit-form');
            const depositMethod = document.getElementById('deposit-method');
            
            // Yöntem değişikliğinde form alanlarını göster/gizle
            depositMethod.addEventListener('change', function() {
                toggleMethodFields(this.value);
            });
            
            // Form gönderimi
            depositForm.addEventListener('submit', function(e) {
                e.preventDefault();
                submitDepositRequest();
            });
            
            // Kart numarası formatlaması
            const cardNumber = document.getElementById('card-number');
            if (cardNumber) {
                cardNumber.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/\s/g, '').replace(/[^0-9]/gi, '');
                    let formattedValue = value.match(/.{1,4}/g)?.join(' ');
                    e.target.value = formattedValue || value;
                });
            }
            
            // CVV sadece sayı
            const cardCvv = document.getElementById('card-cvv');
            if (cardCvv) {
                cardCvv.addEventListener('input', function(e) {
                    e.target.value = e.target.value.replace(/[^0-9]/g, '');
                });
            }
            
            // Expiry date formatlaması
            const cardExpiry = document.getElementById('card-expiry');
            if (cardExpiry) {
                cardExpiry.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/\D/g, '');
                    if (value.length >= 2) {
                        value = value.substring(0, 2) + '/' + value.substring(2, 4);
                    }
                    e.target.value = value;
                });
            }
        }
        
        // Yöntem alanlarını göster/gizle
        function toggleMethodFields(method) {
            const methodFields = document.querySelectorAll('.method-fields');
            methodFields.forEach(field => {
                field.style.display = 'none';
            });
            
            if (method) {
                const selectedMethodFields = document.getElementById(method + '-fields');
                if (selectedMethodFields) {
                    selectedMethodFields.style.display = 'block';
                }
            }
        }
        
        // Para yatırma talebi gönder
        async function submitDepositRequest() {
            const method = document.getElementById('deposit-method').value;
            const amount = parseFloat(document.getElementById('deposit-amount').value);
            const note = document.getElementById('deposit-note').value;
            
            if (!method) {
                showNotification('Lütfen yatırma yöntemini seçin!', 'error');
                return;
            }
            
            if (!amount || amount < 10) {
                showNotification('Minimum yatırım tutarı ₺10\'dur!', 'error');
                return;
            }
            
            if (amount > 50000) {
                showNotification('Maksimum yatırım tutarı ₺50,000\'dir!', 'error');
                return;
            }
            
            // Yönteme göre ek alanları kontrol et
            let detailBilgiler = {};
            
            if (method === 'kredi_karti') {
                const cardNumber = document.getElementById('card-number').value;
                const cardExpiry = document.getElementById('card-expiry').value;
                const cardCvv = document.getElementById('card-cvv').value;
                const cardHolder = document.getElementById('card-holder').value;
                
                if (!cardNumber || !cardExpiry || !cardCvv || !cardHolder) {
                    showNotification('Lütfen tüm kart bilgilerini doldurun!', 'error');
                    return;
                }
                
                detailBilgiler = {
                    card_number: cardNumber.replace(/\s/g, '').substring(0, 4) + '****' + cardNumber.replace(/\s/g, '').substring(-4),
                    card_holder: cardHolder
                };
            } else if (method === 'papara') {
                const paparaNumber = document.getElementById('papara-number').value;
                if (!paparaNumber) {
                    showNotification('Lütfen Papara numaranızı girin!', 'error');
                    return;
                }
                detailBilgiler = { papara_number: paparaNumber };
            } else if (method === 'havale') {
                const senderName = document.getElementById('sender-name').value;
                const senderIban = document.getElementById('sender-iban').value;
                
                if (!senderName || !senderIban) {
                    showNotification('Lütfen gönderen bilgilerini doldurun!', 'error');
                    return;
                }
                detailBilgiler = { sender_name: senderName, sender_iban: senderIban };
            }
            
            try {
                const formData = new FormData();
                formData.append('yontem', method);
                formData.append('tutar', amount);
                formData.append('detay_bilgiler', JSON.stringify(detailBilgiler));
                if (note) formData.append('aciklama', note);
                
                const response = await fetch('backend/user/deposits.php?action=create', {
                    method: 'POST',
                    credentials: 'include',
                    body: formData
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showNotification(`Para yatırma talebiniz başarıyla gönderildi! Talep ID: ${data.data.id}`, 'success');
                    document.getElementById('deposit-form').reset();
                    toggleMethodFields(''); // Hide all method fields
                    loadRecentDeposits(); // Reload recent deposits
                } else {
                    showNotification('Hata: ' + (data.error || 'Talep gönderilemedi'), 'error');
                }
            } catch (error) {
                console.error('Para yatırma hatası:', error);
                showNotification('Talep gönderilirken bir hata oluştu: ' + error.message, 'error');
            }
        }
        
        // Son para yatırma taleplerini yükle
        async function loadRecentDeposits() {
            const container = document.getElementById('recent-deposits');
            
            try {
                const response = await fetch('backend/user/deposits.php?action=list', {
                    method: 'GET',
                    credentials: 'include'
                });
                
                const data = await response.json();
                
                if (data.success && data.data.length > 0) {
                    let depositsHTML = '<div style="display: flex; flex-direction: column; gap: 12px;">';
                    
                    data.data.forEach(deposit => {
                        const statusClass = deposit.durum === 'beklemede' ? 'status-pending' : 
                                          deposit.durum === 'onaylandi' ? 'status-approved' : 'status-rejected';
                        const statusText = deposit.durum === 'beklemede' ? 'Beklemede' : 
                                         deposit.durum === 'onaylandi' ? 'Onaylandı' : 'Reddedildi';
                        
                        depositsHTML += `
                            <div style="background: rgba(255, 255, 255, 0.05); padding: 16px; border-radius: 12px; border-left: 4px solid ${deposit.durum === 'beklemede' ? '#fbbf24' : deposit.durum === 'onaylandi' ? '#00d4aa' : '#ef4444'};">
                                <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 8px;">
                                    <div>
                                        <strong style="color: #ffffff;">${deposit.yontem.charAt(0).toUpperCase() + deposit.yontem.slice(1).replace('_', ' ')}</strong>
                                        <span style="margin-left: 12px; color: #8b8fa3;">₺${parseFloat(deposit.tutar).toLocaleString()}</span>
                                    </div>
                                    <span class="status-badge ${statusClass}" style="padding: 4px 8px; border-radius: 12px; font-size: 11px; font-weight: 600;">${statusText}</span>
                                </div>
                                <div style="color: #8b8fa3; font-size: 12px;">
                                    ${new Date(deposit.tarih).toLocaleDateString('tr-TR')} ${new Date(deposit.tarih).toLocaleTimeString('tr-TR')}
                                </div>
                            </div>
                        `;
                    });
                    
                    depositsHTML += '</div>';
                    container.innerHTML = depositsHTML;
                } else {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: #8b8fa3;">
                            <i class="fas fa-info-circle" style="font-size: 24px; margin-bottom: 12px;"></i>
                            <p>Henüz para yatırma talebiniz bulunmuyor.</p>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Para yatırma talepleri yüklenirken hata:', error);
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #ef4444;">
                        <i class="fas fa-exclamation-triangle" style="font-size: 24px; margin-bottom: 12px;"></i>
                        <p>Talepler yüklenirken bir hata oluştu.</p>
                    </div>
                `;
            }
        }
        
        // Notification göster
        function showNotification(message, type = 'info') {
            // Notification container oluştur
            let container = document.getElementById('notification-container');
            if (!container) {
                container = document.createElement('div');
                container.id = 'notification-container';
                container.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    z-index: 10000;
                    max-width: 400px;
                `;
                document.body.appendChild(container);
            }
            
            // Notification elemanı oluştur
            const notification = document.createElement('div');
            notification.style.cssText = `
                background: ${type === 'success' ? '#00d4aa' : type === 'error' ? '#ef4444' : '#3b82f6'};
                color: white;
                padding: 16px 20px;
                border-radius: 12px;
                margin-bottom: 12px;
                box-shadow: 0 8px 32px rgba(0,0,0,0.2);
                transform: translateX(100%);
                transition: transform 0.3s ease;
                font-weight: 500;
                display: flex;
                align-items: center;
                gap: 12px;
            `;
            
            const icon = type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle';
            notification.innerHTML = `<i class="fas ${icon}"></i> ${message}`;
            
            container.appendChild(notification);
            
            // Animasyon
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            // Otomatik kaldır
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 5000);
        }

        // Mobile menu toggle
        function toggleMobileMenu() {
            const sidebar = document.querySelector('.sidebar');
            const overlay = document.querySelector('.mobile-overlay');
            
            sidebar.classList.toggle('mobile-open');
            overlay.classList.toggle('active');
        }

        // Close mobile menu
        function closeMobileMenu() {
            const sidebar = document.querySelector('.sidebar');
            const overlay = document.querySelector('.mobile-overlay');
            
            sidebar.classList.remove('mobile-open');
            overlay.classList.remove('active');
        }

        // Close mobile menu when clicking navigation items
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', closeMobileMenu);
        });

        // Window resize event for responsive design
        window.addEventListener('resize', function() {
            // Re-render coins if needed
            if (window.innerWidth <= 768) {
                const mobileGrid = document.getElementById('mobileCoinsGrid');
                if (mobileGrid && mobileGrid.children.length > 0) {
                    // Mobile grid is already rendered, no need to re-render
                }
            } else {
                const mobileGrid = document.getElementById('mobileCoinsGrid');
                if (mobileGrid) {
                    mobileGrid.style.display = 'none';
                    document.getElementById('marketTable').style.display = 'block';
                }
            }
        });

                 // Modern hibrit sistem - Veritabanı + API kombinasyonu
         async function fetchMarketData() {
             const searchInput = document.getElementById('coinSearch') ? document.getElementById('coinSearch').value.toLowerCase() : '';
             const marketLoader = document.getElementById('marketLoader');

             try {
                 // Loading state göster
                 if (marketLoader) {
                     marketLoader.style.display = 'flex';
                     marketLoader.innerHTML = `
                         <div style="text-align: center; padding: 40px;">
                             <div style="width: 48px; height: 48px; border: 3px solid rgba(79, 195, 247, 0.3); border-top: 3px solid #4fc3f7; border-radius: 50%; margin: 0 auto 16px; animation: spin 1s linear infinite;"></div>
                             <p style="color: #8896ab;">Piyasa verileri yükleniyor...</p>
                         </div>
                     `;
                 }
                 
                 // Hibrit endpoint'den veri çek
                 const params = new URLSearchParams({
                     limit: 50,
                     search: searchInput
                 });
                 
                 const response = await fetch(`backend/user/coins_hybrid.php?${params}`, {
                     method: 'GET',
                     credentials: 'include'
                 });
                 
                 if (!response.ok) {
                     throw new Error(`API Error: ${response.status} ${response.statusText}`);
                 }
                 
                 const result = await response.json();
                 console.log('✅ Market data loaded:', result);

                 if (result.success && result.coins && result.coins.length > 0) {
                     // Modern card-based rendering kullan
                     renderModernCoins(result.coins);
                     
                     // API durumu bilgisi göster (opsiyonel bilgi kutusu)
                     if (result.api_active_count > 0) {
                         showApiStatusInfo(result.total_count, result.api_active_count);
                     }
                     
                     // Loader'ı gizle
                     if (marketLoader) {
                         marketLoader.style.display = 'none';
                     }
                     
                     // Başarı mesajı
                     if (typeof showNotification === 'function') {
                         showNotification(`${result.total_count} coin yüklendi`, 'success');
                     }
                     
                 } else {
                     showNoCoinsMessage(searchInput);
                     if (marketLoader) {
                         marketLoader.style.display = 'none';
                     }
                 }
                 
             } catch (error) {
                 console.error('❌ Error fetching market data:', error);
                 showErrorMessage();
             }
         }
         
                 // refreshMarketData alias - geriye uyumluluk için
        function refreshMarketData() {
            return fetchMarketData();
        }
        
        // Portföy yükle
        async function loadPortfolio() {
            const loader = document.getElementById('portfolioLoader');
            const empty = document.getElementById('portfolioEmpty');
            const table = document.getElementById('portfolioTable');
            
            // Loading state göster
            loader.style.display = 'block';
            empty.style.display = 'none';
            table.style.display = 'none';
            
            try {
                const response = await fetch('backend/user/trading.php?action=portfolio', {
                    method: 'GET',
                    credentials: 'include'
                });
                
                const result = await response.json();
                console.log('✅ Portfolio loaded:', result);
                
                if (result.success && result.data.portfolio.length > 0) {
                    displayPortfolio(result.data);
                } else {
                    // Portföy boş
                    loader.style.display = 'none';
                    empty.style.display = 'block';
                    
                    // Sıfır değerleri göster
                    document.getElementById('portfolioTotalValue').textContent = '₺0';
                    document.getElementById('portfolioProfitLoss').textContent = '₺0';
                    document.getElementById('portfolioProfitPercent').textContent = '0%';
                    document.getElementById('portfolioCoinCount').textContent = '0';
                }
                
            } catch (error) {
                console.error('Portfolio loading error:', error);
                loader.style.display = 'none';
                empty.style.display = 'none';
                table.style.display = 'block';
                
                document.getElementById('portfolioTableBody').innerHTML = `
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 40px; color: #ef4444;">
                            <i class="fas fa-exclamation-triangle" style="font-size: 24px; margin-bottom: 12px;"></i><br>
                            Portföy verilerini yüklerken hata oluştu.<br>
                            <button onclick="loadPortfolio()" style="background: #4fc3f7; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; margin-top: 12px;">
                                Tekrar Dene
                            </button>
                        </td>
                    </tr>
                `;
            }
        }
        
        // Portföy verilerini göster
        function displayPortfolio(data) {
            const loader = document.getElementById('portfolioLoader');
            const table = document.getElementById('portfolioTable');
            const tbody = document.getElementById('portfolioTableBody');
            
            // Loading'i gizle, tabloyu göster
            loader.style.display = 'none';
            table.style.display = 'block';
            
            // Özet bilgilerini güncelle
            const summary = data.summary;
            document.getElementById('portfolioTotalValue').textContent = `₺${summary.total_value.toLocaleString('tr-TR', {minimumFractionDigits: 2})}`;
            document.getElementById('portfolioProfitLoss').textContent = `₺${summary.total_profit_loss.toLocaleString('tr-TR', {minimumFractionDigits: 2})}`;
            document.getElementById('portfolioProfitPercent').textContent = `${summary.total_profit_loss_percent.toFixed(2)}%`;
            document.getElementById('portfolioCoinCount').textContent = summary.coin_count;
            
            // Profit/Loss rengini ayarla
            const profitElement = document.getElementById('portfolioProfitLoss');
            const percentElement = document.getElementById('portfolioProfitPercent');
            const profitClass = summary.total_profit_loss >= 0 ? 'positive' : 'negative';
            profitElement.style.color = summary.total_profit_loss >= 0 ? '#00d4aa' : '#ef4444';
            percentElement.style.color = summary.total_profit_loss >= 0 ? '#00d4aa' : '#ef4444';
            
            // Tablo içeriğini oluştur
            tbody.innerHTML = '';
            
            data.portfolio.forEach(item => {
                const profitLossClass = item.profit_loss >= 0 ? 'positive' : 'negative';
                const profitLossColor = item.profit_loss >= 0 ? '#00d4aa' : '#ef4444';
                const logoUrl = item.logo_url || `https://via.placeholder.com/32/4fc3f7/ffffff?text=${item.coin_kodu.charAt(0)}`;
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <img src="${logoUrl}" alt="${item.coin_adi}" 
                                 style="width: 32px; height: 32px; border-radius: 50%;"
                                 onerror="this.src='https://via.placeholder.com/32/4fc3f7/ffffff?text=${item.coin_kodu.charAt(0)}'">
                            <div>
                                <div style="font-weight: 600; color: #ffffff;">${item.coin_adi}</div>
                                <div style="font-size: 12px; color: #8b8fa3;">${item.coin_kodu}</div>
                            </div>
                        </div>
                    </td>
                    <td style="font-family: monospace;">${parseFloat(item.net_miktar).toFixed(6)}</td>
                    <td>₺${parseFloat(item.avg_buy_price).toLocaleString('tr-TR', {minimumFractionDigits: 2})}</td>
                    <td>₺${parseFloat(item.current_price).toLocaleString('tr-TR', {minimumFractionDigits: 2})}</td>
                    <td style="font-weight: 600;">₺${parseFloat(item.current_value).toLocaleString('tr-TR', {minimumFractionDigits: 2})}</td>
                    <td style="color: ${profitLossColor}; font-weight: 600;">
                        ${item.profit_loss >= 0 ? '+' : ''}₺${parseFloat(item.profit_loss).toLocaleString('tr-TR', {minimumFractionDigits: 2})}
                    </td>
                    <td style="color: ${profitLossColor}; font-weight: 600;">
                        ${item.profit_loss_percent >= 0 ? '+' : ''}${parseFloat(item.profit_loss_percent).toFixed(2)}%
                    </td>
                    <td>
                        <div style="display: flex; gap: 8px;">
                            <button onclick="openTradingModal('${item.coin_id}', '${item.coin_adi}', '${item.current_price}', 'buy', '${item.coin_kodu}')" 
                                    style="background: #00d4aa; color: white; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 12px;">
                                <i class="fas fa-plus"></i> Al
                            </button>
                            <button onclick="openTradingModal('${item.coin_id}', '${item.coin_adi}', '${item.current_price}', 'sell', '${item.coin_kodu}')" 
                                    style="background: #ef4444; color: white; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 12px;">
                                <i class="fas fa-minus"></i> Sat
                            </button>
                        </div>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
            
            // Başarı mesajı göster
            if (typeof showNotification === 'function') {
                showNotification(`Portföy yüklendi: ${summary.coin_count} farklı varlık`, 'success');
            }
        }
         
         // API durum bilgisini göster
         function showApiStatusInfo(totalCount, apiActiveCount) {
             // Başlığın altına bilgi kutusu ekle
             const statusInfo = document.createElement('div');
             statusInfo.className = 'api-status-info';
             statusInfo.style.cssText = `
                 background: linear-gradient(135deg, rgba(79, 195, 247, 0.1) 0%, rgba(41, 182, 246, 0.05) 100%);
                 border: 1px solid rgba(79, 195, 247, 0.2);
                 border-radius: 12px;
                 padding: 16px 24px;
                 margin: 16px 32px;
                 display: flex;
                 align-items: center;
                 gap: 12px;
                 font-size: 13px;
                 color: #8896ab;
             `;
             statusInfo.innerHTML = `
                 <i class="fas fa-info-circle" style="color: #4fc3f7;"></i>
                 <span>📊 ${totalCount} coin yüklendi • 🟢 ${apiActiveCount} canlı fiyat • 🔴 ${totalCount - apiActiveCount} sabit fiyat</span>
             `;
             
             // Eski status info'yu kaldır
             const existingStatus = document.querySelector('.api-status-info');
             if (existingStatus) existingStatus.remove();
             
             // Yeni status info'yu ekle
             const marketContainer = document.querySelector('.modern-market-container');
             const marketFilters = document.querySelector('.market-filters');
             marketContainer.insertBefore(statusInfo, marketFilters.nextSibling);
         }
         
         // Realistic Mini Chart çizme fonksiyonu
         function drawRealisticMiniChart(coinId, currentPrice) {
             const canvas = document.getElementById('miniPriceChart');
             if (!canvas) return;
             
             // Responsive canvas boyutları
             const isMobile = window.innerWidth <= 768;
             const canvasWidth = isMobile ? 120 : 140;
             const canvasHeight = isMobile ? 65 : 70;
             
             canvas.width = canvasWidth;
             canvas.height = canvasHeight;
             
             const ctx = canvas.getContext('2d');
             const width = canvas.width;
             const height = canvas.height;
             const padding = 4; // Chart padding
             const chartWidth = width - padding * 2;
             const chartHeight = height - padding * 2;
             
             // Canvas'ı temizle
             ctx.clearRect(0, 0, width, height);
             
             // Daha gerçekçi fiyat verisi oluştur (25 nokta)
             const dataPoints = 25;
             const priceData = [];
             let basePrice = parseFloat(currentPrice) || 45000;
             
             // Crypto volatility ve momentum simulation
             let momentum = 0;
             let currentPricePoint = basePrice;
             
             for (let i = 0; i < dataPoints; i++) {
                 // Realistic crypto volatility (%1.5)
                 const volatility = (Math.random() - 0.5) * 0.015;
                 
                 // Market trend (subtle sine wave)
                 const marketTrend = Math.sin((i / dataPoints) * Math.PI * 1.5) * 0.008;
                 
                 // Momentum factor (simulates buying/selling pressure)
                 momentum = momentum * 0.7 + (Math.random() - 0.5) * 0.005;
                 
                 // Random walk with mean reversion
                 const meanReversion = (basePrice - currentPricePoint) / basePrice * 0.1;
                 
                 // Combine all factors
                 const priceChange = volatility + marketTrend + momentum + meanReversion;
                 currentPricePoint *= (1 + priceChange);
                 
                 // Ensure price doesn't go negative or too extreme
                 currentPricePoint = Math.max(currentPricePoint, basePrice * 0.85);
                 currentPricePoint = Math.min(currentPricePoint, basePrice * 1.15);
                 
                 priceData.push(currentPricePoint);
             }
             
             // Calculate trend and price range
             const minPrice = Math.min(...priceData);
             const maxPrice = Math.max(...priceData);
             const priceRange = maxPrice - minPrice || 1; // Prevent division by zero
             const isUpTrend = priceData[priceData.length - 1] > priceData[0];
             const trendStrength = Math.abs(priceData[priceData.length - 1] - priceData[0]) / priceData[0];
             
             // Professional color scheme
             const trendColor = isUpTrend ? '#00E676' : '#FF5252'; // Material Design colors
             const trendColorRGB = isUpTrend ? '0, 230, 118' : '255, 82, 82';
             
             // Create sophisticated gradient
             const fillGradient = ctx.createLinearGradient(0, padding, 0, height - padding);
             fillGradient.addColorStop(0, `rgba(${trendColorRGB}, ${0.35 + trendStrength * 0.2})`);
             fillGradient.addColorStop(0.6, `rgba(${trendColorRGB}, ${0.15 + trendStrength * 0.1})`);
             fillGradient.addColorStop(1, `rgba(${trendColorRGB}, 0.02)`);
             
             // Draw subtle grid lines
             ctx.strokeStyle = `rgba(79, 195, 247, 0.08)`;
             ctx.lineWidth = 0.5;
             
             // Horizontal grid lines
             for (let i = 1; i <= 2; i++) {
                 const y = padding + (chartHeight / 3) * i;
                 ctx.beginPath();
                 ctx.moveTo(padding, y);
                 ctx.lineTo(width - padding, y);
                 ctx.stroke();
             }
             
             // Draw main price line
             ctx.strokeStyle = trendColor;
             ctx.lineWidth = 2.2;
             ctx.lineCap = 'round';
             ctx.lineJoin = 'round';
             ctx.shadowColor = trendColor;
             ctx.shadowBlur = 3;
             ctx.shadowOffsetY = 0;
             
             ctx.beginPath();
             priceData.forEach((price, index) => {
                 const x = padding + (chartWidth / (dataPoints - 1)) * index;
                 const y = padding + chartHeight - ((price - minPrice) / priceRange) * chartHeight;
                 
                 if (index === 0) {
                     ctx.moveTo(x, y);
                 } else {
                     ctx.lineTo(x, y);
                 }
             });
             ctx.stroke();
             ctx.shadowBlur = 0; // Reset shadow
             
             // Fill area under curve
             ctx.fillStyle = fillGradient;
             ctx.beginPath();
             priceData.forEach((price, index) => {
                 const x = padding + (chartWidth / (dataPoints - 1)) * index;
                 const y = padding + chartHeight - ((price - minPrice) / priceRange) * chartHeight;
                 
                 if (index === 0) {
                     ctx.moveTo(x, y);
                 } else {
                     ctx.lineTo(x, y);
                 }
             });
             ctx.lineTo(width - padding, height - padding);
             ctx.lineTo(padding, height - padding);
             ctx.closePath();
             ctx.fill();
             
             // Draw last price point highlight
             const lastIndex = priceData.length - 1;
             const lastX = padding + (chartWidth / (dataPoints - 1)) * lastIndex;
             const lastY = padding + chartHeight - ((priceData[lastIndex] - minPrice) / priceRange) * chartHeight;
             
             // Outer glow
             ctx.beginPath();
             ctx.arc(lastX, lastY, 4, 0, 2 * Math.PI);
             ctx.fillStyle = `rgba(${trendColorRGB}, 0.3)`;
             ctx.fill();
             
             // Inner point
             ctx.beginPath();
             ctx.arc(lastX, lastY, 2, 0, 2 * Math.PI);
             ctx.fillStyle = trendColor;
             ctx.fill();
             ctx.strokeStyle = '#ffffff';
             ctx.lineWidth = 1;
             ctx.stroke();
             
             // Update trend indicators
             updateTrendIndicators(isUpTrend, trendStrength);
         }
         
         // Trend indicator güncelleme fonksiyonu
         function updateTrendIndicators(isUpTrend, trendStrength) {
             const trendIcon = document.querySelector('.trend-icon');
             const chartIndicator = document.querySelector('.chart-trend-indicator');
             
             if (trendIcon) {
                 trendIcon.className = `fas fa-trending-${isUpTrend ? 'up' : 'down'} trend-icon${isUpTrend ? '' : ' down'}`;
             }
             
             if (chartIndicator) {
                 const intensity = Math.min(trendStrength * 3, 0.4); // Max 0.4 opacity
                 chartIndicator.style.background = isUpTrend 
                     ? `rgba(0, 230, 118, ${0.25 + intensity})` 
                     : `rgba(255, 82, 82, ${0.25 + intensity})`;
             }
         }
         
         // Mini chart kaldırıldı - Sadece Chart.js kullanıyoruz
         
         // Chart.js ile animasyonlu grafik oluştur
         let tradingChart = null;
         
         // Sayfa yüklendiğinde Chart.js'in hazır olduğunu garanti et
         window.addEventListener('load', function() {
            // Chart.js hazır
         });
         
         function initTradingChart() {
             console.log('🚀🚀🚀 initTradingChart başlatıldı!');
             
             // Chart.js yüklenmiş mi kontrol et
             if (typeof Chart === 'undefined') {
                 console.error('❌❌❌ Chart.js yüklenmemiş!');
                 setTimeout(initTradingChart, 1000); // 1 saniye bekle ve tekrar dene
                 return;
             }
             
             console.log('✅✅✅ Chart.js yüklendi');
             
             const chartContainer = document.querySelector('.chart-container-modern');
             console.log('📦 Chart container:', chartContainer);
             
             const ctx = document.getElementById('tradingChart');
             console.log('📊 Canvas element:', ctx);
             
             if (!ctx) {
                 console.error('❌❌❌ tradingChart canvas bulunamadı!');
                 return;
             }
             
             console.log('✅✅✅ Canvas bulundu!');
             console.log('📏 Canvas dimensions:', ctx.width, 'x', ctx.height);
             console.log('🎨 Canvas style:', ctx.style.cssText);
             
             if (!ctx) {
                 console.error('❌ tradingChart canvas bulunamadı!');
                 return;
             }
             
             // Eğer önceki chart varsa yok et
             if (tradingChart) {
                 tradingChart.destroy();
             }
             
                         // Çok basit test verisi
             const data = [];
             for (let i = 0; i < 20; i++) { // Sadece 20 nokta
                 data.push({
                     x: i,
                     y: 45000 + (i * 100) + (Math.random() * 200 - 100) // Basit artan trend
                 });
             }
             
             // Çok basit chart konfigürasyonu
             const config = {
                 type: 'line',
                 data: {
                     labels: data.map((_, index) => index),
                     datasets: [{
                         label: 'Test',
                         data: data.map(d => d.y),
                         borderColor: '#ff0000',
                         backgroundColor: 'rgba(255, 0, 0, 0.5)',
                         borderWidth: 5,
                         fill: false,
                         tension: 0,
                         pointRadius: 5,
                         pointBackgroundColor: '#ff0000',
                         pointBorderColor: '#ffffff',
                         pointBorderWidth: 2,
                     }]
                 },
                 options: {
                     responsive: true,
                     maintainAspectRatio: false,
                     plugins: {
                         legend: {
                             display: true
                         }
                     },
                     scales: {
                         x: {
                             type: 'linear',
                             display: true,
                             grid: {
                                 color: '#ffffff',
                                 drawBorder: true,
                             },
                             ticks: {
                                 color: '#ffffff',
                                 font: {
                                     size: 14
                                 }
                             }
                         },
                         y: {
                             display: true,
                             grid: {
                                 color: '#ffffff',
                                 drawBorder: true,
                             },
                             ticks: {
                                 color: '#ffffff',
                                 font: {
                                     size: 14
                                 }
                             }
                         }
                     },
                     animation: {
                         duration: 0 // Kendi animasyonumuzu kullanacağız
                     },
                     interaction: {
                         intersect: false,
                         mode: 'index'
                     }
                 }
             };
             
             // Chart'ı oluştur
                          try {
                 console.log('🎨🎨🎨 Chart oluşturuluyor...');
                 console.log('📊 Data length:', data.length);
                 console.log('📊 Sample data:', data.slice(0, 5));
                 console.log('⚙️ Config type:', config.type);
                 
                 tradingChart = new Chart(ctx, config);
                 console.log('✅✅✅ Chart başarıyla oluşturuldu');
                 
                 tradingChart.update();
                 console.log('✅✅✅ Chart render edildi');
                 
                 // Chart'ın gerçekten render edilip edilmediğini kontrol et
                 setTimeout(() => {
                     console.log('🔍 Chart render kontrolü...');
                     console.log('📊 Chart data:', tradingChart.data);
                     console.log('📏 Chart canvas size:', tradingChart.canvas.width, 'x', tradingChart.canvas.height);
                 }, 1000);
                 
             } catch (error) {
                 console.error('❌❌❌ Chart oluşturulurken hata:', error);
                 console.error('❌❌❌ Error stack:', error.stack);
             }
         }
         
         // Modal kapanırken chart'ı temizle
         function destroyTradingChart() {
             if (tradingChart) {
                 tradingChart.destroy();
                 tradingChart = null;
             }
         }
         
         // Coin bulunamadı mesajı
         function showNoCoinsMessage(searchInput) {
             const marketLoader = document.getElementById('marketLoader');
             marketLoader.innerHTML = `
                 <div style="text-align: center; color: #8896ab; padding: 40px;">
                     <i class="fas fa-search" style="font-size: 48px; margin-bottom: 16px; opacity: 0.3;"></i>
                     <h3 style="color: #ffffff; margin-bottom: 12px;">
                         ${searchInput ? 'Coin Bulunamadı' : 'Coin Listesi Boş'}
                     </h3>
                     <p style="margin-bottom: 20px;">
                         ${searchInput ? 'Aradığınız kripto para bulunamadı' : 'Veritabanında coin bulunamadı'}
                     </p>
                     <button onclick="fetchMarketData()" style="background: #4fc3f7; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer;">
                         <i class="fas fa-sync-alt"></i> Yenile
                     </button>
                 </div>
             `;
         }
         
         // Hata mesajı
         function showErrorMessage() {
             const marketLoader = document.getElementById('marketLoader');
             if (marketLoader) {
                 marketLoader.style.display = 'flex';
                 marketLoader.innerHTML = `
                     <div style="text-align: center; color: #f44336; padding: 40px;">
                         <i class="fas fa-exclamation-triangle" style="font-size: 48px; margin-bottom: 16px; opacity: 0.5;"></i>
                         <h3 style="color: #ffffff; margin-bottom: 12px;">Bağlantı Hatası</h3>
                         <p style="color: #8896ab; margin-bottom: 20px;">Piyasa verileri yüklenirken hata oluştu. API bağlantısını kontrol edin.</p>
                         <button onclick="refreshMarketData()" style="background: #4fc3f7; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; margin-right: 10px;">
                             <i class="fas fa-redo"></i> Tekrar Dene
                         </button>
                         <button onclick="showMockMarketData()" style="background: #28a745; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer;">
                             <i class="fas fa-eye"></i> Demo Veriler
                         </button>
                     </div>
                 `;
             }
             
             // Kullanıcıya bildirim göster
             if (typeof showNotification === 'function') {
                 showNotification('Piyasa verileri yüklenemedi. Demo veriler gösteriliyor.', 'error');
             }
         }
         
         // Mock piyasa verileri göster
         function showMockMarketData() {
             const mockCoins = [
                 {
                     id: 1,
                     coin_adi: 'Bitcoin',
                     coin_kodu: 'BTC',
                     current_price: 96480.50,
                     price_change_24h: 2.35,
                     market_cap: 1900000000000,
                     logo_url: 'https://assets.coingecko.com/coins/images/1/large/bitcoin.png'
                 },
                 {
                     id: 2,
                     coin_adi: 'Ethereum',
                     coin_kodu: 'ETH',
                     current_price: 3420.75,
                     price_change_24h: -1.22,
                     market_cap: 410000000000,
                     logo_url: 'https://assets.coingecko.com/coins/images/279/large/ethereum.png'
                 },
                 {
                     id: 3,
                     coin_adi: 'BNB',
                     coin_kodu: 'BNB',
                     current_price: 685.20,
                     price_change_24h: 0.88,
                     market_cap: 99000000000,
                     logo_url: 'https://assets.coingecko.com/coins/images/825/large/bnb-icon2_2x.png'
                 },
                 {
                     id: 4,
                     coin_adi: 'Solana',
                     coin_kodu: 'SOL',
                     current_price: 238.45,
                     price_change_24h: 4.65,
                     market_cap: 113000000000,
                     logo_url: 'https://assets.coingecko.com/coins/images/4128/large/solana.png'
                 },
                 {
                     id: 5,
                     coin_adi: 'XRP',
                     coin_kodu: 'XRP',
                     current_price: 2.35,
                     price_change_24h: 12.88,
                     market_cap: 133000000000,
                     logo_url: 'https://assets.coingecko.com/coins/images/44/large/xrp-symbol-white-128.png'
                 }
             ];
             
             renderModernCoins(mockCoins);
             document.getElementById('marketLoader').style.display = 'none';
             
             // Başarı mesajı göster
             if (typeof showNotification === 'function') {
                 showNotification('Demo piyasa verileri yüklendi.', 'success');
             }
         }

                                  // Trading modalını aç - İyileştirilmiş
        function openTradingModal(coinId, coinName, currentPrice, direction = 'buy', coinSymbol = '') {
            console.log('🚀 TRADING MODAL AÇILIYOR!', { coinId, coinName, currentPrice, direction, coinSymbol });
            const modal = document.getElementById('tradingModal');
            
            // Global değişkenlere kaydet (executeOrder için)
            window.currentTradingCoin = {
                id: coinId,
                name: coinName,
                price: parseFloat(currentPrice),
                symbol: coinSymbol || coinName.substring(0, 3).toUpperCase()
            };
            
            // Modal animasyonu başlat
            modal.style.display = 'flex';
            requestAnimationFrame(() => {
                const container = modal.querySelector('.modal-container');
                container.style.transform = 'scale(1)';
                container.style.opacity = '1';
            });
            
            // Coin bilgilerini modal'a yükle
            document.getElementById('modalCoinName').textContent = coinName;
            document.getElementById('modalCoinSymbol').textContent = coinSymbol || coinName.substring(0, 3).toUpperCase();
            
            // Fiyatı TL cinsinden göster
            const priceInTL = parseFloat(currentPrice) * 30; // USD -> TL tahmini
            document.getElementById('modalCoinPrice').textContent = `₺${priceInTL.toLocaleString('tr-TR', {minimumFractionDigits: 2})}`;
            
            // Gerçek price_change_24h kullan (coin verisinde varsa)
            const changeElement = document.getElementById('modalCoinChange');
            if (window.currentCoinData && window.currentCoinData.price_change_24h) {
                const change = parseFloat(window.currentCoinData.price_change_24h);
                changeElement.textContent = `${change >= 0 ? '+' : ''}${change.toFixed(2)}%`;
                changeElement.className = `price-change ${change >= 0 ? 'positive' : 'negative'}`;
            } else {
                // Fallback
                const change = (Math.random() - 0.5) * 10;
                changeElement.textContent = `${change >= 0 ? '+' : ''}${change.toFixed(2)}%`;
                changeElement.className = `price-change ${change >= 0 ? 'positive' : 'negative'}`;
            }
            
            // Al/Sat fiyatlarını güncelle (0.1% spread)
            const buyPrice = priceInTL * 1.001;
            const sellPrice = priceInTL * 0.999;
            document.getElementById('buyPrice').textContent = `₺${buyPrice.toFixed(2)}`;
            document.getElementById('sellPrice').textContent = `₺${sellPrice.toFixed(2)}`;
           
           // 24H Yüksek/Düşük verilerini güncelle
           const high = priceInTL * (1.05 + Math.random() * 0.15);
           const low = priceInTL * (0.85 - Math.random() * 0.15);
           document.getElementById('modalCoinHigh').textContent = `₺${high.toFixed(2)}`;
           document.getElementById('modalCoinLow').textContent = `₺${low.toFixed(2)}`;
            
            // Quantity suffix'i güncelle
            const symbol = coinSymbol || coinName.substring(0, 3).toUpperCase();
            document.getElementById('quantitySuffix').textContent = symbol;
            
            // Direction'a göre initial text ayarla
            const executeText = document.getElementById('executeText');
            const executeBtn = document.getElementById('executeOrderBtn');
            if (direction === 'buy') {
                executeText.textContent = `${symbol} Al`;
                executeBtn.className = 'execute-btn buy-order';
                document.querySelector('[data-direction="buy"]').classList.add('active');
                document.querySelector('[data-direction="sell"]').classList.remove('active');
            } else {
                executeText.textContent = `${symbol} Sat`;
                executeBtn.className = 'execute-btn sell-order';
                document.querySelector('[data-direction="sell"]').classList.add('active');
                document.querySelector('[data-direction="buy"]').classList.remove('active');
            }
            
            // Trading modalı için event listener'ları kurulum
            setupTradingModalEvents();
             
             // Chart.js grafiğini başlat
             setTimeout(() => {
                 console.log('📊📊📊 Chart başlatılıyor...');
                 initTradingChart();
            }, 800); // Modal tamamen açıldıktan sonra
         }

         // Trading modalını kapat
         function closeTradingModal() {
             const modal = document.getElementById('tradingModal');
             const container = modal.querySelector('.modal-container');
             
             // Chart animasyonunu durdur
             stopChartAnimation();
             
             // Chart.js grafiğini temizle
             destroyTradingChart();
             
             container.style.transform = 'scale(0.95)';
             container.style.opacity = '0';
             
             setTimeout(() => {
                 modal.style.display = 'none';
                 
                 // Chart'ı sıfırla
                 const placeholder = document.getElementById('chartPlaceholder');
                 const fakeChart = document.getElementById('fake-chart');
                 if (placeholder && fakeChart) {
                     fakeChart.style.display = 'none';
                     placeholder.style.display = 'flex';
                 }
             }, 200);
         }

         // Trading modal event listener'ları
         function setupTradingModalEvents() {
             // Direction toggle
             document.querySelectorAll('.direction-btn').forEach(btn => {
                 btn.addEventListener('click', function() {
                     document.querySelectorAll('.direction-btn').forEach(b => b.classList.remove('active'));
                     this.classList.add('active');
                     
                     const direction = this.dataset.direction;
                     const executeBtn = document.getElementById('executeOrderBtn');
                     const executeText = document.getElementById('executeText');
                     const coinSymbol = document.getElementById('modalCoinSymbol').textContent;
                     
                     if (direction === 'buy') {
                         executeBtn.className = 'execute-btn buy-order';
                         executeText.textContent = `${coinSymbol} Al`;
                     } else {
                         executeBtn.className = 'execute-btn sell-order';
                         executeText.textContent = `${coinSymbol} Sat`;
                     }
                 });
             });

             // Order type değişikliği
             document.getElementById('orderType').addEventListener('change', function() {
                 const priceGroup = document.getElementById('priceGroup');
                 if (this.value === 'limit' || this.value === 'stop_limit') {
                     priceGroup.style.display = 'block';
                 } else {
                     priceGroup.style.display = 'none';
                 }
             });

             // Amount tabs
             document.querySelectorAll('.amount-tab').forEach(tab => {
                 tab.addEventListener('click', function() {
                     document.querySelectorAll('.amount-tab').forEach(t => t.classList.remove('active'));
                     this.classList.add('active');
                     
                     const type = this.dataset.type;
                     const quantityGroup = document.getElementById('quantityGroup');
                     const totalGroup = document.getElementById('totalGroup');
                     
                     if (type === 'quantity') {
                         quantityGroup.style.display = 'block';
                         totalGroup.style.display = 'none';
                     } else {
                         quantityGroup.style.display = 'none';
                         totalGroup.style.display = 'block';
                     }
                 });
             });

             // Percentage buttons
             document.querySelectorAll('.percent-btn').forEach(btn => {
                 btn.addEventListener('click', function() {
                     const percent = parseInt(this.dataset.percent);
                     const balance = 10000; // User balance (gerçek değer backend'den gelecek)
                     const price = parseFloat(document.getElementById('modalCoinPrice').textContent.replace('₺', '').replace(',', ''));
                     
                     const totalAmount = (balance * percent) / 100;
                     const quantity = totalAmount / price;
                     
                     document.getElementById('orderQuantity').value = quantity.toFixed(6);
                     updateOrderSummary();
                 });
             });

             // Input değişiklikleri
             ['orderQuantity', 'orderTotal', 'orderPrice'].forEach(id => {
                 const element = document.getElementById(id);
                 if (element) {
                     element.addEventListener('input', updateOrderSummary);
                 }
             });

             // Timeframe buttons
             document.querySelectorAll('.timeframe-btn').forEach(btn => {
                 btn.addEventListener('click', function() {
                     document.querySelectorAll('.timeframe-btn').forEach(b => b.classList.remove('active'));
                     this.classList.add('active');
                     
                     // Grafik timeframe'ini değiştir
                     const timeframe = this.dataset.timeframe;
                     updateChartTimeframe(timeframe);
                 });
             });

             // Execute order
             document.getElementById('executeOrderBtn').addEventListener('click', executeOrder);
         }

         // Order özeti güncelle
         function updateOrderSummary() {
             const quantity = parseFloat(document.getElementById('orderQuantity').value) || 0;
             const price = parseFloat(document.getElementById('modalCoinPrice').textContent.replace('₺', '').replace(',', '')) || 0;
             const orderPrice = parseFloat(document.getElementById('orderPrice').value) || price;
             
             const total = quantity * orderPrice;
             const fee = total * 0.001; // 0.1% fee
             const totalWithFee = total + fee;
             
             document.getElementById('orderTotalValue').textContent = `₺${total.toFixed(2)}`;
             document.getElementById('tradingFee').textContent = `₺${fee.toFixed(2)}`;
             
             // Execute button'ı etkinleştir/devre dışı bırak
             const executeBtn = document.getElementById('executeOrderBtn');
             executeBtn.disabled = quantity <= 0 || total <= 0;
         }

                 // Order'ı execute et
        async function executeOrder() {
            if (!window.currentTradingCoin) {
                showNotification('Coin bilgisi bulunamadı', 'error');
                return;
            }
            
            const direction = document.querySelector('.direction-btn.active').dataset.direction;
            const quantity = parseFloat(document.getElementById('orderQuantity').value);
            const currentPrice = window.currentTradingCoin.price * 30; // USD -> TL
            
            if (!quantity || quantity <= 0) {
                showNotification('Geçerli bir miktar giriniz', 'error');
                return;
            }
            
            // Loading state
            const executeBtn = document.getElementById('executeOrderBtn');
            const originalText = executeBtn.innerHTML;
            executeBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> İşleniyor...';
            executeBtn.disabled = true;
            
            try {
                const formData = new FormData();
                formData.append('coin_id', window.currentTradingCoin.id);
                formData.append('miktar', quantity);
                formData.append('fiyat', currentPrice);
                
                const response = await fetch(`backend/user/trading.php?action=${direction}`, {
                    method: 'POST',
                    credentials: 'include',
                    body: formData
                });
                
                const result = await response.json();
                
                if (result.success) {
                    const directionText = direction === 'buy' ? 'SATIN ALMA' : 'SATIM';
                    const totalAmount = result.data.toplam_tutar;
                    
                    showNotification(
                        `✅ ${directionText} İşlemi Başarılı!\n` +
                        `${quantity} ${window.currentTradingCoin.symbol} - ₺${totalAmount.toLocaleString('tr-TR')}`,
                        'success'
                    );
                    
                    // Modal'ı kapat
                    closeTradingModal();
                    
                    // Kullanıcı bilgilerini ve portföyü güncelle
                    loadUserInfo();
                    if (typeof loadPortfolio === 'function') {
                        loadPortfolio();
                    }
                    
                } else {
                    showNotification(`❌ İşlem Hatası: ${result.message}`, 'error');
                }
                
            } catch (error) {
                console.error('Trading API Error:', error);
                showNotification('❌ Bağlantı hatası. Lütfen tekrar deneyin.', 'error');
            } finally {
                // Loading state'i kaldır
                executeBtn.innerHTML = originalText;
                executeBtn.disabled = false;
            }
        }

                 // Sahte grafik yükle
         function loadFakeChart(symbol) {
             const fakeChart = document.getElementById('fake-chart');
             const placeholder = document.getElementById('chartPlaceholder');
             
             // Placeholder'ı gizle
             placeholder.style.display = 'none';
             fakeChart.style.display = 'block';
             
             // Canvas grafik çiz
             createFakePriceChart(symbol);
         }
         
         // Sahte fiyat grafiği oluştur
         function createFakePriceChart(symbol) {
             const canvas = document.getElementById('priceChart');
             const ctx = canvas.getContext('2d');
             
             // Canvas boyutlarını ayarla
             canvas.width = canvas.offsetWidth;
             canvas.height = canvas.offsetHeight;
             
             // Gerçekçi fiyat verisi oluştur
             const prices = generateFakePriceData();
             drawPriceChart(ctx, prices, symbol);
             
             // Animasyonlu fiyat güncellemesi
             setInterval(() => {
                 updateFakePrice(ctx, symbol);
             }, 3000);
         }
         
         // Sahte fiyat verisi oluştur
         function generateFakePriceData() {
             const data = [];
             let price = 45000 + Math.random() * 5000;
             
             for (let i = 0; i < 100; i++) {
                 price += (Math.random() - 0.5) * 200;
                 data.push({
                     x: i,
                     y: price
                 });
             }
             
             return data;
         }
         
         // Grafik çiz
         function drawPriceChart(ctx, data, symbol) {
             const width = ctx.canvas.width;
             const height = ctx.canvas.height;
             
             // Arka plan
             ctx.fillStyle = '#141927';
             ctx.fillRect(0, 0, width, height);
             
             // Grid çizgileri
             ctx.strokeStyle = '#2a2f3e';
             ctx.lineWidth = 1;
             
             for (let i = 0; i <= 10; i++) {
                 const y = (height / 10) * i;
                 ctx.beginPath();
                 ctx.moveTo(0, y);
                 ctx.lineTo(width, y);
                 ctx.stroke();
             }
             
             // Fiyat çizgisi
             ctx.strokeStyle = '#00d4aa';
             ctx.lineWidth = 2;
             ctx.beginPath();
             
             data.forEach((point, index) => {
                 const x = (width / data.length) * index;
                 const y = height - ((point.y - 40000) / 10000) * height;
                 
                 if (index === 0) {
                     ctx.moveTo(x, y);
                 } else {
                     ctx.lineTo(x, y);
                 }
             });
             
             ctx.stroke();
             
             // Fiyat etiketi
             ctx.fillStyle = '#ffffff';
             ctx.font = '14px Arial';
             ctx.fillText(`${symbol.toUpperCase()}: ₺${data[data.length - 1].y.toFixed(2)}`, 10, 20);
         }
         
         // Fiyat güncelle
         function updateFakePrice(ctx, symbol) {
             const currentPrice = 45000 + Math.random() * 5000;
             
             // Fiyat etiketini güncelle
             ctx.fillStyle = '#141927';
             ctx.fillRect(0, 0, 200, 30);
             
             ctx.fillStyle = '#ffffff';
             ctx.font = '14px Arial';
             ctx.fillText(`${symbol.toUpperCase()}: ₺${currentPrice.toFixed(2)}`, 10, 20);
         }
         
         // Advanced options toggle
        function toggleAdvancedOptions() {
            const content = document.getElementById('advancedContent');
            const icon = document.querySelector('.advanced-toggle i');
            
            if (content.style.display === 'none') {
                content.style.display = 'block';
                icon.style.transform = 'rotate(180deg)';
            } else {
                content.style.display = 'none';
                icon.style.transform = 'rotate(0deg)';
            }
        }

        // Modern coin rendering - her iki platform için
        function renderModernCoins(coins) {
            const marketLoader = document.getElementById('marketLoader');
            const desktopGrid = document.getElementById('desktopCoinsGrid');
            const mobileGrid = document.getElementById('mobileCoinsGrid');
            
            marketLoader.style.display = 'none';
            
            // Desktop grid render
            renderDesktopCoins(coins, desktopGrid);
            
            // Mobile grid render
            renderMobileCoins(coins, mobileGrid);
            
            // Grids'i göster
            desktopGrid.style.display = window.innerWidth > 768 ? 'grid' : 'none';
            mobileGrid.style.display = window.innerWidth <= 768 ? 'grid' : 'none';
            
            // Update last update time
            document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString('tr-TR', {
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        // Desktop coin kartları render et
        function renderDesktopCoins(coins, container) {
            container.innerHTML = '';
            
            coins.forEach((coin, index) => {
                const priceChangeClass = coin.price_change_24h >= 0 ? 'positive' : 'negative';
                const priceChangeIcon = coin.price_change_24h >= 0 ? '▲' : '▼';
                const logoUrl = coin.logo_url || `https://via.placeholder.com/48/4fc3f7/ffffff?text=${coin.coin_kodu.charAt(0)}`;
                
                const card = document.createElement('div');
                card.className = 'desktop-coin-card';
                card.onclick = () => openTradingModal(coin.id, coin.coin_adi, coin.current_price, 'buy', coin.coin_kodu);
                
                card.innerHTML = `
                    <div class="coin-card-header">
                        <div class="coin-info">
                            <div class="coin-logo">
                                <img src="${logoUrl}" alt="${coin.coin_adi}" 
                                     onerror="this.style.display='none'; this.parentNode.textContent='${coin.coin_kodu.charAt(0)}'">
                            </div>
                            <div class="coin-details">
                                <h4>${coin.coin_adi}</h4>
                                <span class="coin-symbol">${coin.coin_kodu}</span>
                            </div>
                        </div>
                        <div class="coin-price">
                            <div class="price">$${parseFloat(coin.current_price).toLocaleString('en-US', { 
                                minimumFractionDigits: 2, 
                                maximumFractionDigits: 8 
                            })}</div>
                            <div class="rank">#${index + 1}</div>
                        </div>
                    </div>
                    
                    <div class="coin-stats">
                        <div class="price-change ${priceChangeClass}">
                            <i class="fas fa-${coin.price_change_24h >= 0 ? 'arrow-up' : 'arrow-down'}"></i>
                            ${parseFloat(coin.price_change_24h).toFixed(2)}%
                        </div>
                        <div class="volume-info">
                            Piyasa Değeri: $${coin.market_cap ? (parseInt(coin.market_cap) / 1000000).toFixed(1) + 'M' : 'N/A'}
                        </div>
                    </div>
                    
                    <div class="coin-actions">
                        <button class="trade-btn buy" onclick="event.stopPropagation(); openTradingModal('${coin.id}', '${coin.coin_adi}', '${coin.current_price}', 'buy', '${coin.coin_kodu}')">
                            <i class="fas fa-arrow-up"></i> Alış
                        </button>
                        <button class="trade-btn sell" onclick="event.stopPropagation(); openTradingModal('${coin.id}', '${coin.coin_adi}', '${coin.current_price}', 'sell', '${coin.coin_kodu}')">
                            <i class="fas fa-arrow-down"></i> Satış
                        </button>
                    </div>
                `;
                
                container.appendChild(card);
            });
        }

        // Mobil coin kartları render et
        function renderMobileCoins(coins, container) {
            container.innerHTML = '';
            
            coins.forEach((coin, index) => {
                const priceChangeClass = coin.price_change_24h >= 0 ? 'positive' : 'negative';
                const priceChangeIcon = coin.price_change_24h >= 0 ? '▲' : '▼';
                const logoUrl = coin.logo_url || `https://via.placeholder.com/50/4fc3f7/ffffff?text=${coin.coin_kodu.charAt(0)}`;
                
                const card = document.createElement('div');
                card.className = 'mobile-coin-card';
                card.innerHTML = `
                    <div class="mobile-coin-header">
                        <div class="mobile-coin-info">
                            <div class="mobile-coin-logo">
                                <img src="${logoUrl}" alt="${coin.coin_adi}" 
                                     style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover;"
                                     onerror="this.style.display='none'; this.parentNode.textContent='${coin.coin_kodu.charAt(0)}'">
                            </div>
                            <div class="mobile-coin-details">
                                <h3>${coin.coin_adi}</h3>
                                <span class="coin-symbol">${coin.coin_kodu}</span>
                            </div>
                        </div>
                        <div class="mobile-coin-price">
                            $${parseFloat(coin.current_price).toLocaleString('en-US', { 
                                minimumFractionDigits: 2, 
                                maximumFractionDigits: 6 
                            })}
                        </div>
                    </div>
                    
                    <div class="mobile-coin-stats">
                        <div class="mobile-coin-change ${priceChangeClass}">
                            ${priceChangeIcon} ${parseFloat(coin.price_change_24h).toFixed(2)}%
                        </div>
                        <div class="mobile-coin-volume">
                            Vol: $${coin.market_cap ? (parseInt(coin.market_cap) / 1000000).toFixed(1) + 'M' : 'N/A'}
                        </div>
                    </div>
                    
                    <div class="mobile-coin-actions">
                        <button class="mobile-trade-btn buy" onclick="openTradingModal('${coin.id}', '${coin.coin_adi}', '${coin.current_price}', 'buy', '${coin.coin_kodu}')">
                            <i class="fas fa-arrow-up"></i> Alış
                        </button>
                        <button class="mobile-trade-btn sell" onclick="openTradingModal('${coin.id}', '${coin.coin_adi}', '${coin.current_price}', 'sell', '${coin.coin_kodu}')">
                            <i class="fas fa-arrow-down"></i> Satış
                        </button>
                    </div>
                `;
                
                container.appendChild(card);
            });
         }

         // Global chart variables
         let chartAnimationFrame;
         let chartData = {
             priceData: [],
             timeLabels: [],
             animationProgress: 0,
             isAnimating: false,
             lastUpdate: 0,
             coinId: '',
             basePrice: 0
         };

         // Animasyonlu grafik çizme fonksiyonu
         function drawPriceChart(coinId, currentPrice) {
             const canvas = document.getElementById('priceChart');
             const placeholder = document.getElementById('chartPlaceholder');
             const ctx = canvas.getContext('2d');
             
             // Canvas boyutlarını ayarla
             const rect = canvas.getBoundingClientRect();
             canvas.width = rect.width * window.devicePixelRatio;
             canvas.height = rect.height * window.devicePixelRatio;
             ctx.scale(window.devicePixelRatio, window.devicePixelRatio);
             
             // Placeholder'ı gizle
             placeholder.style.display = 'none';
             canvas.style.display = 'block';
             
             // Chart data'yı inicialize et
             initializeChartData(coinId, currentPrice);
             
             // Animasyonu başlat
             startChartAnimation(ctx, rect);
         }

         // Chart data'yı inicialize et
         function initializeChartData(coinId, currentPrice) {
             chartData.coinId = coinId;
             chartData.basePrice = parseFloat(currentPrice);
             chartData.priceData = [];
             chartData.timeLabels = [];
             chartData.animationProgress = 0;
             chartData.isAnimating = true;
             
             const dataPoints = 50;
             
             for (let i = dataPoints; i >= 0; i--) {
                 const variation = (Math.random() - 0.5) * 0.15; // %15 varyasyon
                 const trend = Math.sin((i / dataPoints) * Math.PI * 2) * 0.05; // Sinüs trend
                 const noise = (Math.random() - 0.5) * 0.03; // Küçük gürültü
                 const price = chartData.basePrice * (1 + variation + trend + noise);
                 chartData.priceData.push(price);
                 
                 const time = new Date();
                 time.setMinutes(time.getMinutes() - i * 5);
                 chartData.timeLabels.push(time.toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' }));
             }
         }

         // Chart animasyonunu başlat
         function startChartAnimation(ctx, rect) {
             const startTime = performance.now();
             
             function animate(currentTime) {
                 const elapsed = currentTime - startTime;
                 const duration = 2000; // 2 saniye animasyon
                 
                 chartData.animationProgress = Math.min(elapsed / duration, 1);
                 
                 // Canvas'ı temizle
                 ctx.clearRect(0, 0, rect.width, rect.height);
                 
                 // Grafiği çiz
                 drawAnimatedChart(ctx, rect);
                 
                 if (chartData.animationProgress < 1) {
                     chartAnimationFrame = requestAnimationFrame(animate);
                 } else {
                     // Animasyon tamamlandı, canlı güncellemeleri başlat
                     startLiveUpdates(ctx, rect);
                 }
             }
             
             chartAnimationFrame = requestAnimationFrame(animate);
         }

         // Animasyonlu chart çiz
         function drawAnimatedChart(ctx, rect) {
             const padding = 40;
             const chartWidth = rect.width - padding * 2;
             const chartHeight = rect.height - padding * 2;
             
             // Min/Max değerleri bul
             const minPrice = Math.min(...chartData.priceData);
             const maxPrice = Math.max(...chartData.priceData);
             const priceRange = maxPrice - minPrice;
             
             // Grid çiz (fade in)
             const gridOpacity = chartData.animationProgress * 0.1;
             ctx.strokeStyle = `rgba(255, 255, 255, ${gridOpacity})`;
             ctx.lineWidth = 1;
             
             // Yatay grid çizgileri
             for (let i = 0; i <= 5; i++) {
                 const y = padding + (chartHeight / 5) * i;
                 ctx.beginPath();
                 ctx.moveTo(padding, y);
                 ctx.lineTo(padding + chartWidth, y);
                 ctx.stroke();
                 
                 // Fiyat etiketleri (fade in)
                 const price = maxPrice - (priceRange / 5) * i;
                 ctx.fillStyle = `rgba(136, 150, 171, ${chartData.animationProgress})`;
                 ctx.font = '12px Inter, sans-serif';
                 ctx.textAlign = 'right';
                 ctx.fillText('$' + price.toFixed(2), padding - 10, y + 4);
             }
             
             // Dikey grid çizgileri
             for (let i = 0; i <= 10; i++) {
                 const x = padding + (chartWidth / 10) * i;
                 ctx.beginPath();
                 ctx.moveTo(x, padding);
                 ctx.lineTo(x, padding + chartHeight);
                 ctx.stroke();
             }
             
             // Animasyonlu fiyat çizgisi
             const dataPoints = chartData.priceData.length;
             const currentPoints = Math.floor(dataPoints * chartData.animationProgress);
             
             if (currentPoints > 1) {
                 // Ana çizgi
                 ctx.strokeStyle = '#4fc3f7';
                 ctx.lineWidth = 3;
                 ctx.beginPath();
                 
                 for (let i = 0; i < currentPoints; i++) {
                     const x = padding + (chartWidth / (dataPoints - 1)) * i;
                     const y = padding + chartHeight - ((chartData.priceData[i] - minPrice) / priceRange) * chartHeight;
                     
                     if (i === 0) {
                         ctx.moveTo(x, y);
                     } else {
                         ctx.lineTo(x, y);
                     }
                 }
                 ctx.stroke();
                 
                 // Gradient fill (animasyonlu)
                 const gradient = ctx.createLinearGradient(0, padding, 0, padding + chartHeight);
                 const fillOpacity = chartData.animationProgress * 0.3;
                 gradient.addColorStop(0, `rgba(79, 195, 247, ${fillOpacity})`);
                 gradient.addColorStop(1, `rgba(79, 195, 247, ${fillOpacity * 0.1})`);
                 
                 ctx.fillStyle = gradient;
                 ctx.beginPath();
                 
                 for (let i = 0; i < currentPoints; i++) {
                     const x = padding + (chartWidth / (dataPoints - 1)) * i;
                     const y = padding + chartHeight - ((chartData.priceData[i] - minPrice) / priceRange) * chartHeight;
                     
                     if (i === 0) {
                         ctx.moveTo(x, y);
                     } else {
                         ctx.lineTo(x, y);
                     }
                 }
                 
                 // Fill to bottom
                 if (currentPoints > 0) {
                     const lastX = padding + (chartWidth / (dataPoints - 1)) * (currentPoints - 1);
                     ctx.lineTo(lastX, padding + chartHeight);
                     ctx.lineTo(padding, padding + chartHeight);
                 }
                 ctx.closePath();
                 ctx.fill();
                 
                 // Animating dot at the end
                 if (currentPoints > 0) {
                     const lastIndex = currentPoints - 1;
                     const lastX = padding + (chartWidth / (dataPoints - 1)) * lastIndex;
                     const lastY = padding + chartHeight - ((chartData.priceData[lastIndex] - minPrice) / priceRange) * chartHeight;
                     
                     // Pulsing effect
                     const pulseScale = 1 + Math.sin(performance.now() * 0.01) * 0.3;
                     
                     ctx.beginPath();
                     ctx.arc(lastX, lastY, 6 * pulseScale, 0, 2 * Math.PI);
                     ctx.fillStyle = '#4fc3f7';
                     ctx.fill();
                     ctx.strokeStyle = '#ffffff';
                     ctx.lineWidth = 2;
                     ctx.stroke();
                 }
             }
             
             // Başlık (fade in)
             ctx.fillStyle = `rgba(255, 255, 255, ${chartData.animationProgress})`;
             ctx.font = 'bold 16px Inter, sans-serif';
             ctx.textAlign = 'left';
             ctx.fillText(`${chartData.coinId.toUpperCase()}/USD Price Chart`, padding, 25);
             
             // Son fiyat (fade in)
             if (chartData.priceData.length > 0) {
                 ctx.fillStyle = `rgba(79, 195, 247, ${chartData.animationProgress})`;
                 ctx.font = 'bold 14px Inter, sans-serif';
                 ctx.textAlign = 'right';
                 const currentIndex = Math.min(Math.floor(chartData.priceData.length * chartData.animationProgress), chartData.priceData.length - 1);
                 ctx.fillText('$' + chartData.priceData[currentIndex].toFixed(6), rect.width - padding, 25);
             }
         }

         // Canlı güncellemeleri başlat
         function startLiveUpdates(ctx, rect) {
             function updatePrice() {
                 // Yeni fiyat noktası ekle
                 const lastPrice = chartData.priceData[chartData.priceData.length - 1];
                 const change = (Math.random() - 0.5) * 0.02; // %2 değişim
                 const newPrice = lastPrice * (1 + change);
                 
                 // Array'i kaydır ve yeni fiyat ekle
                 chartData.priceData.shift();
                 chartData.priceData.push(newPrice);
                 
                 // Time label'ı güncelle
                 chartData.timeLabels.shift();
                 const now = new Date();
                 chartData.timeLabels.push(now.toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' }));
                 
                 // Grafiği yeniden çiz
                 ctx.clearRect(0, 0, rect.width, rect.height);
                 chartData.animationProgress = 1; // Tam görünür
                 drawAnimatedChart(ctx, rect);
                 
                 // Modal price'ı güncelle
                 document.getElementById('modalCoinPrice').textContent = `$${newPrice.toLocaleString()}`;
                 
                 // 3 saniye sonra tekrar güncelle
                 setTimeout(updatePrice, 3000);
             }
             
             // İlk güncellemeyi 3 saniye sonra başlat
             setTimeout(updatePrice, 3000);
         }

                   // Modal kapandığında animasyonu durdur
          function stopChartAnimation() {
              if (chartAnimationFrame) {
                  cancelAnimationFrame(chartAnimationFrame);
                  chartAnimationFrame = null;
              }
              chartData.isAnimating = false;
          }

          // Timeframe değiştir
          function updateChartTimeframe(timeframe) {
              if (!chartData.isAnimating && chartData.priceData.length > 0) {
                  // Farklı timeframe'ler için farklı data pattern'leri
                  const patterns = {
                      '1m': { volatility: 0.01, trend: 0.02 },
                      '5m': { volatility: 0.02, trend: 0.03 },
                      '15m': { volatility: 0.03, trend: 0.04 },
                      '1h': { volatility: 0.05, trend: 0.06 },
                      '4h': { volatility: 0.08, trend: 0.08 },
                      '1d': { volatility: 0.12, trend: 0.10 }
                  };
                  
                  const pattern = patterns[timeframe] || patterns['1h'];
                  
                  // Yeni data generate et
                  const dataPoints = 50;
                  const newPriceData = [];
                  
                  for (let i = 0; i < dataPoints; i++) {
                      const variation = (Math.random() - 0.5) * pattern.volatility;
                      const trend = Math.sin((i / dataPoints) * Math.PI * 3) * pattern.trend;
                      const noise = (Math.random() - 0.5) * (pattern.volatility * 0.3);
                      const price = chartData.basePrice * (1 + variation + trend + noise);
                      newPriceData.push(price);
                  }
                  
                  chartData.priceData = newPriceData;
                  
                  // Grafiği smooth transition ile güncelle
                  const canvas = document.getElementById('priceChart');
                  const ctx = canvas.getContext('2d');
                  const rect = canvas.getBoundingClientRect();
                  
                  // Kısa animasyonla güncelle
                  let progress = 0;
                  function updateTransition() {
                      progress += 0.1;
                      if (progress <= 1) {
                          ctx.clearRect(0, 0, rect.width, rect.height);
                          chartData.animationProgress = 1;
                          drawAnimatedChart(ctx, rect);
                          requestAnimationFrame(updateTransition);
                      }
                  }
                  requestAnimationFrame(updateTransition);
              }
          }

         // Filter fonksiyonları
        function initializeMarketFilters() {
            const filterChips = document.querySelectorAll('.filter-chip');
            filterChips.forEach(chip => {
                chip.addEventListener('click', function() {
                    // Aktif filter'ı değiştir
                    filterChips.forEach(f => f.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Filter uygula (şimdilik demo)
                    const filter = this.dataset.filter;
                    console.log('Filter uygulandı:', filter);
                    
                    // Burada gerçek filtreleme mantığı olacak
                    // fetchMarketData() çağrısı ile backend'e filter parametresi gönderilebilir
                });
            });
        }
        
        // Search input için debounced arama
        function initializeCoinSearch() {
            const searchInput = document.getElementById('coinSearch');
            let searchTimeout;
            
            searchInput.addEventListener('input', function() {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => {
                    fetchMarketData();
                }, 500); // 500ms debounce
            });
        }
        
        // Responsive listener
        function initializeResponsiveListeners() {
            let resizeTimeout;
            window.addEventListener('resize', function() {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(() => {
                    // Grid görünümlerini tekrar düzenle
                    const desktopGrid = document.getElementById('desktopCoinsGrid');
                    const mobileGrid = document.getElementById('mobileCoinsGrid');
                    
                    if (desktopGrid && mobileGrid) {
                        if (window.innerWidth > 768) {
                            desktopGrid.style.display = 'grid';
                            mobileGrid.style.display = 'none';
                        } else {
                            desktopGrid.style.display = 'none';
                            mobileGrid.style.display = 'grid';
                        }
                    }
                }, 250);
            });
        }
        
        // Page init
        function initializeMarketPage() {
            initializeMarketFilters();
            initializeCoinSearch();
            initializeResponsiveListeners();
            
            // İlk veri yüklemesi
            fetchMarketData();
          }

         // Sayfa yüklendiğinde piyasaları yükle
        async function refreshMarketData() {
            await fetchMarketData();
        }

        // Trading sistem değişkenleri
        let selectedForexPair = null;
        let currentTradeDirection = 'long';

        // Trading sistemini başlat
        function initTrading() {
            loadForexPairs();
            setupTradingEventListeners();
        }

        // Forex pair'leri yükle
        async function loadForexPairs() {
            const forexLoader = document.getElementById('forexLoader');
            const forexPairsList = document.getElementById('forexPairsList');

            try {
                // Şimdilik mock data kullan - sonra backend endpoint eklenecek
                const mockForexData = [
                    { id: 1, symbol: 'EURUSD', display_name: 'EUR/USD', category: 'major', current_price: 1.08500, bid_price: 1.08480, ask_price: 1.08520, spread: 4.0, pip_value: 0.0001, max_leverage: 500 },
                    { id: 2, symbol: 'GBPUSD', display_name: 'GBP/USD', category: 'major', current_price: 1.26800, bid_price: 1.26780, ask_price: 1.26820, spread: 4.0, pip_value: 0.0001, max_leverage: 500 },
                    { id: 3, symbol: 'USDJPY', display_name: 'USD/JPY', category: 'major', current_price: 148.250, bid_price: 148.230, ask_price: 148.270, spread: 4.0, pip_value: 0.01, max_leverage: 500 },
                    { id: 4, symbol: 'XAUUSD', display_name: 'Gold', category: 'commodities', current_price: 2685.50, bid_price: 2685.00, ask_price: 2686.00, spread: 10.0, pip_value: 0.01, max_leverage: 200 },
                    { id: 5, symbol: 'US30', display_name: 'Dow Jones', category: 'indices', current_price: 42580.50, bid_price: 42578.0, ask_price: 42583.0, spread: 5.0, pip_value: 1.0, max_leverage: 100 }
                ];

                renderForexPairs(mockForexData);
                forexLoader.style.display = 'none';
                forexPairsList.style.display = 'block';

            } catch (error) {
                console.error('Forex pairs yükleme hatası:', error);
                forexPairsList.innerHTML = '<p style="color: #ff4757; text-align: center; padding: 20px;">Forex verileri yüklenemedi</p>';
                forexLoader.style.display = 'none';
                forexPairsList.style.display = 'block';
            }
        }

        // Forex pair'leri renderla
        function renderForexPairs(pairs) {
            const container = document.getElementById('forexPairsList');
            container.innerHTML = '';

            pairs.forEach(pair => {
                const priceDirection = Math.random() > 0.5 ? 'up' : 'down';
                const priceColor = priceDirection === 'up' ? '#00d4aa' : '#ff4757';
                const priceIcon = priceDirection === 'up' ? '▲' : '▼';

                const pairElement = document.createElement('div');
                pairElement.className = 'forex-pair-item';
                pairElement.dataset.pairId = pair.id;
                pairElement.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="flex: 1;">
                            <div class="pair-symbol">${pair.display_name}</div>
                            <div class="pair-category">${pair.category} • Max Leverage 1:${pair.max_leverage}</div>
                        </div>
                        <div style="text-align: right; min-width: 120px;">
                            <div class="pair-price ${priceDirection === 'up' ? 'price-up' : 'price-down'}">
                                ${pair.current_price} ${priceIcon}
                            </div>
                            <div class="pair-spread">Spread ${pair.spread} pips</div>
                        </div>
                    </div>
                `;

                pairElement.addEventListener('click', () => selectForexPair(pair));
                container.appendChild(pairElement);
            });
        }

        // Forex pair seç
        function selectForexPair(pair) {
            selectedForexPair = pair;

            // Seçili pair'i görsel olarak işaretle
            document.querySelectorAll('.forex-pair-item').forEach(item => {
                item.classList.remove('selected');
            });
            document.querySelector(`[data-pair-id="${pair.id}"]`).classList.add('selected');

            // Trading form'unu aktif et
            document.getElementById('tradingForm').style.display = 'block';
            document.getElementById('noSelectionMessage').style.display = 'none';

            // Pair bilgilerini güncelle
            document.getElementById('selectedPairInfo').innerHTML = `
                <strong>${pair.display_name}</strong> | Price: ${pair.current_price} | Spread: ${pair.spread} pips | Max Leverage: 1:${pair.max_leverage}
            `;

            // Kaldıraç seçeneklerini güncelle
            updateLeverageOptions(pair.max_leverage);

            // Hesaplamaları güncelle
            updateTradeCalculations();
        }

        // Kaldıraç seçeneklerini güncelle
        function updateLeverageOptions(maxLeverage) {
            const leverageSelect = document.getElementById('leverageRatio');
            leverageSelect.innerHTML = '';

            const leverageOptions = [10, 50, 100, 200, 500].filter(lev => lev <= maxLeverage);
            leverageOptions.forEach(leverage => {
                const option = document.createElement('option');
                option.value = leverage;
                option.textContent = `1:${leverage}`;
                if (leverage === 100 && leverage <= maxLeverage) option.selected = true;
                leverageSelect.appendChild(option);
            });
        }

        // Trade hesaplamalarını güncelle
        function updateTradeCalculations() {
            if (!selectedForexPair) return;

            const lotSize = parseFloat(document.getElementById('lotSize').value);
            const leverage = parseInt(document.getElementById('leverageRatio').value);

            // Basit margin hesaplaması
            const contractSize = 100000; // Standard lot size
            const price = selectedForexPair.current_price;
            const requiredMargin = (lotSize * contractSize * price) / leverage;

            // Pip değeri hesaplama
            const pipValue = lotSize * contractSize * selectedForexPair.pip_value;

            // DOM'u güncelle
            document.getElementById('requiredMargin').textContent = `$${requiredMargin.toFixed(2)}`;
            document.getElementById('pipValue').textContent = `$${pipValue.toFixed(2)}`;
            document.getElementById('spreadValue').textContent = `${selectedForexPair.spread} pips`;
            document.getElementById('contractSize').textContent = `${(lotSize * contractSize).toLocaleString()}`;

            // Trade butonunu aktif et
            document.getElementById('openTradeBtn').disabled = false;
        }

        // Trading event listener'ları kurulum
        function setupTradingEventListeners() {
            // Direction buttons
            document.getElementById('longBtn').addEventListener('click', function() {
                setTradeDirection('long');
            });
            document.getElementById('shortBtn').addEventListener('click', function() {
                setTradeDirection('short');
            });

            // Form değişiklikleri
            ['lotSize', 'leverageRatio'].forEach(id => {
                document.getElementById(id).addEventListener('change', updateTradeCalculations);
            });

            // Trade açma butonu
            document.getElementById('openTradeBtn').addEventListener('click', openTrade);

            // Kategori filtreleri
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    // Filter logic burada eklenecek
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                });
            });
        }

        // Trade direction değiştir
        function setTradeDirection(direction) {
            currentTradeDirection = direction;
            document.querySelectorAll('.trade-direction-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(direction + 'Btn').classList.add('active');
        }

        // Trade aç
        async function openTrade() {
            if (!selectedForexPair) {
                alert('Lütfen bir forex pair seçin');
                return;
            }

            const tradeData = {
                pair_id: selectedForexPair.id,
                trade_type: currentTradeDirection,
                lot_size: parseFloat(document.getElementById('lotSize').value),
                leverage_ratio: parseInt(document.getElementById('leverageRatio').value),
                stop_loss: document.getElementById('stopLoss').value || null,
                take_profit: document.getElementById('takeProfit').value || null
            };

            try {
                // Şimdilik mock response - sonra gerçek backend endpoint eklenecek
                console.log('Trade açılıyor:', tradeData);
                
                alert(`🚀 ${selectedForexPair.display_name} için ${currentTradeDirection.toUpperCase()} pozisyonu açıldı!\n\nLot: ${tradeData.lot_size}\nKaldıraç: 1:${tradeData.leverage_ratio}\n\nPozisyon yönetimi için backend entegrasyonu yakında...`);
                
                // Form'u resetle
                resetTradingForm();
                
            } catch (error) {
                console.error('Trade açma hatası:', error);
                alert('Trade açılırken hata oluştu');
            }
        }

        // Trading form'unu resetle
        function resetTradingForm() {
            document.getElementById('stopLoss').value = '';
            document.getElementById('takeProfit').value = '';
            updateTradeCalculations();
        }

        // Pozisyonları yenile
        function refreshPositions() {
            const positionsLoader = document.getElementById('positionsLoader');
            const positionsList = document.getElementById('openPositionsList');
            
            positionsLoader.style.display = 'block';
            positionsList.style.display = 'none';
            
            // Mock pozisyon verisi
            setTimeout(() => {
                positionsList.innerHTML = `
                    <div style="text-align: center; color: #8b8fa3; padding: 30px;">
                        <i class="fas fa-chart-line" style="font-size: 48px; margin-bottom: 15px; opacity: 0.3;"></i>
                        <p>Açık pozisyon bulunmuyor</p>
                        <small>Forex pair seçerek trading başlayabilirsiniz</small>
                    </div>
                `;
                positionsLoader.style.display = 'none';
                positionsList.style.display = 'block';
            }, 1000);
        }
        
        // Sayfa yüklendiğinde initialization yap
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Trading Dashboard başlatılıyor...');
            
            // Market sayfası için özel initialization
            if (document.getElementById('coinSearch')) {
                initializeMarketPage();
            }
            
            // Trading sistemi başlat
            if (document.getElementById('forexPairsContainer')) {
                initTrading();
            }
            
            // Kullanıcı verilerini yükle
            loadUserInfo();
        });
    </script>
</body>
</html> 